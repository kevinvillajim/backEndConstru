import { MigrationInterface, QueryRunner } from "typeorm";

export class InitialSchema1749862484781 implements MigrationInterface {
    name = 'InitialSchema1749862484781'

    public async up(queryRunner: QueryRunner): Promise<void> {
        await queryRunner.query(`CREATE TABLE \`budget_templates\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(100) NOT NULL, \`description\` text NULL, \`projectType\` enum ('residential_single', 'residential_multi', 'commercial_small', 'commercial_large', 'industrial', 'infrastructure', 'renovation', 'specialized') NOT NULL, \`scope\` enum ('system', 'company', 'personal', 'shared') NOT NULL, \`geographicalZone\` varchar(50) NOT NULL, \`wasteFactors\` json NULL, \`laborRates\` json NULL, \`laborProductivity\` json NULL, \`indirectCosts\` json NULL, \`professionalFees\` json NULL, \`necCompliance\` json NULL, \`createdBy\` varchar(255) NOT NULL, \`isActive\` tinyint NOT NULL DEFAULT 1, \`isVerified\` tinyint NOT NULL DEFAULT 0, \`usageCount\` int NOT NULL DEFAULT '0', \`averageRating\` decimal(3,2) NULL, \`metadata\` json NULL, \`createdAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updatedAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), INDEX \`idx_budget_template_created_by\` (\`createdBy\`), INDEX \`idx_budget_template_verified\` (\`isVerified\`), INDEX \`idx_budget_template_active\` (\`isActive\`), INDEX \`idx_budget_template_scope\` (\`scope\`), INDEX \`idx_budget_template_geographical_zone\` (\`geographicalZone\`), INDEX \`idx_budget_template_project_type\` (\`projectType\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`budget_line_items\` (\`id\` varchar(36) NOT NULL, \`description\` varchar(255) NOT NULL, \`specifications\` text NULL, \`itemType\` enum ('material', 'labor', 'equipment', 'subcontract', 'other') NOT NULL DEFAULT 'material', \`source\` enum ('calculation', 'manual', 'template', 'imported') NOT NULL DEFAULT 'manual', \`labor_type\` enum ('general', 'specialized', 'technical', 'supervision', 'skilled', 'unskilled') NULL, \`calculation_budget_id\` varchar(255) NOT NULL, \`source_calculation_id\` varchar(255) NULL, \`calculation_parameter_key\` varchar(255) NULL, \`material_id\` varchar(255) NULL, \`quantity\` decimal(10,4) NOT NULL DEFAULT '0.0000', \`unit_of_measure\` varchar(255) NOT NULL DEFAULT 'unidad', \`unit_price\` decimal(10,4) NOT NULL DEFAULT '0.0000', \`waste_percentage\` decimal(5,2) NOT NULL DEFAULT '0.00', \`final_quantity\` decimal(10,4) NOT NULL DEFAULT '0.0000', \`subtotal\` decimal(12,2) NOT NULL DEFAULT '0.00', \`category\` varchar(255) NULL, \`subcategory\` varchar(255) NULL, \`chapter\` varchar(255) NULL, \`cost_code\` varchar(255) NULL, \`regional_factor\` decimal(5,3) NOT NULL DEFAULT '1.000', \`difficulty_factor\` decimal(5,3) NOT NULL DEFAULT '1.000', \`nec_reference\` varchar(255) NULL, \`price_date\` datetime NULL, \`price_source\` varchar(255) NULL, \`price_validity_days\` int NOT NULL DEFAULT '30', \`metadata\` json NULL, \`display_order\` int NOT NULL DEFAULT '0', \`is_optional\` tinyint NOT NULL DEFAULT 0, \`is_alternate\` tinyint NOT NULL DEFAULT 0, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), INDEX \`IDX_budget_line_item_type_source\` (\`itemType\`, \`source\`), INDEX \`IDX_budget_line_item_material\` (\`material_id\`), INDEX \`IDX_budget_line_item_budget\` (\`calculation_budget_id\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`calculation_budgets\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NULL, \`status\` enum ('draft', 'review', 'approved', 'revised', 'final', 'archived') NOT NULL DEFAULT 'draft', \`budgetType\` enum ('materials_only', 'complete_project', 'labor_materials', 'professional_estimate') NOT NULL DEFAULT 'materials_only', \`version\` int NOT NULL DEFAULT '1', \`parent_budget_id\` varchar(255) NULL, \`project_id\` varchar(255) NOT NULL, \`project_type\` varchar(255) NOT NULL DEFAULT 'construction', \`custom_fields\` json NULL, \`user_id\` varchar(255) NOT NULL, \`calculation_result_id\` varchar(255) NULL, \`budget_template_id\` varchar(255) NULL, \`materials_subtotal\` decimal(12,2) NOT NULL DEFAULT '0.00', \`labor_subtotal\` decimal(12,2) NOT NULL DEFAULT '0.00', \`professional_costs_total\` decimal(12,2) NOT NULL DEFAULT '0.00', \`indirect_costs\` decimal(12,2) NOT NULL DEFAULT '0.00', \`contingency_percentage\` decimal(5,2) NOT NULL DEFAULT '5.00', \`contingency_amount\` decimal(12,2) NOT NULL DEFAULT '0.00', \`subtotal\` decimal(12,2) NOT NULL DEFAULT '0.00', \`tax_percentage\` decimal(5,2) NOT NULL DEFAULT '15.00', \`tax_amount\` decimal(12,2) NOT NULL DEFAULT '0.00', \`total\` decimal(12,2) NOT NULL DEFAULT '0.00', \`geographical_zone\` varchar(255) NOT NULL DEFAULT 'costa', \`currency\` varchar(255) NOT NULL DEFAULT 'USD', \`exchange_rate\` decimal(10,4) NOT NULL DEFAULT '1.0000', \`customization\` json NULL, \`exportSettings\` json NULL, \`last_calculated_at\` datetime NULL, \`is_template_budget\` tinyint NOT NULL DEFAULT 0, \`approved_by\` varchar(255) NULL, \`approved_at\` datetime NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), INDEX \`IDX_calc_budget_user_created\` (\`user_id\`, \`created_at\`), INDEX \`IDX_calc_budget_template\` (\`budget_template_id\`), INDEX \`IDX_calc_budget_project_status\` (\`project_id\`, \`status\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`progress_tracking\` (\`id\` varchar(36) NOT NULL, \`reportDate\` date NOT NULL, \`reportTime\` time NULL, \`reportType\` enum ('daily', 'weekly', 'milestone', 'incident', 'quality', 'safety') NOT NULL, \`title\` varchar(255) NOT NULL, \`description\` text NULL, \`overallProgress\` decimal(5,2) NOT NULL, \`previousProgress\` decimal(5,2) NULL, \`progressToday\` decimal(5,2) NOT NULL, \`activityProgress\` json NULL, \`resourcesUsed\` json NULL, \`workingConditions\` json NULL, \`issues\` json NULL, \`qualityControl\` json NULL, \`safetyReport\` json NULL, \`attachments\` json NULL, \`dailyLaborCost\` decimal(15,2) NOT NULL DEFAULT '0.00', \`dailyMaterialCost\` decimal(15,2) NOT NULL DEFAULT '0.00', \`dailyEquipmentCost\` decimal(15,2) NOT NULL DEFAULT '0.00', \`totalDailyCost\` decimal(15,2) NOT NULL DEFAULT '0.00', \`nextDayPlan\` json NULL, \`customFields\` json NULL, \`isApproved\` tinyint NOT NULL DEFAULT 0, \`approvedAt\` date NULL, \`createdAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updatedAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), \`scheduleId\` varchar(255) NOT NULL, \`reportedById\` varchar(255) NOT NULL, \`approvedById\` varchar(255) NULL, \`schedule_id\` varchar(36) NULL, \`reported_by\` varchar(36) NULL, \`approved_by\` varchar(36) NULL, INDEX \`IDX_cfa565542f299054bf8c4b7dfe\` (\`reportType\`, \`reportDate\`), INDEX \`IDX_aef90bb2c16f49e15e863f3149\` (\`scheduleId\`, \`reportDate\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`weather_factors\` (\`id\` varchar(36) NOT NULL, \`date\` date NOT NULL, \`geographicalZone\` enum ('QUITO', 'GUAYAQUIL', 'CUENCA', 'COSTA', 'SIERRA', 'ORIENTE', 'INSULAR') NOT NULL, \`weatherCondition\` varchar(100) NOT NULL, \`temperature\` decimal(5,2) NOT NULL, \`humidity\` decimal(5,2) NOT NULL, \`rainfall\` decimal(6,2) NOT NULL DEFAULT '0.00', \`windSpeed\` decimal(5,2) NULL, \`windDirection\` varchar(50) NULL, \`atmosphericPressure\` decimal(8,2) NULL, \`uvIndex\` int NULL, \`workingSuitability\` enum ('excellent', 'good', 'fair', 'poor', 'unsuitable') NOT NULL DEFAULT 'good', \`productivityFactor\` decimal(3,2) NOT NULL DEFAULT '1.00', \`activityImpacts\` json NULL, \`workRestrictions\` json NULL, \`forecast\` json NULL, \`seasonalData\` json NULL, \`dataSource\` varchar(255) NULL, \`isActual\` tinyint NOT NULL DEFAULT 1, \`customFields\` json NULL, \`createdAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updatedAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), \`scheduleId\` varchar(255) NULL, \`schedule_id\` varchar(36) NULL, INDEX \`IDX_67b15f614b28d1cd69b0fceeea\` (\`geographicalZone\`, \`date\`), INDEX \`IDX_a1c0e4a1753372ec5ab332f017\` (\`scheduleId\`, \`date\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`calculation_schedules\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NULL, \`status\` enum ('draft', 'active', 'on_hold', 'delayed', 'completed', 'cancelled') NOT NULL DEFAULT 'draft', \`constructionType\` enum ('residential_single', 'residential_multi', 'commercial_small', 'commercial_large', 'industrial', 'infrastructure', 'renovation', 'specialized') NOT NULL, \`geographicalZone\` enum ('quito', 'guayaquil', 'cuenca', 'costa', 'sierra', 'oriente', 'insular') NOT NULL, \`plannedStartDate\` date NOT NULL, \`plannedEndDate\` date NOT NULL, \`actualStartDate\` date NULL, \`actualEndDate\` date NULL, \`progressPercentage\` decimal(5,2) NOT NULL DEFAULT '0.00', \`totalPlannedDuration\` decimal(10,2) NOT NULL DEFAULT '0.00', \`totalActualDuration\` decimal(10,2) NOT NULL DEFAULT '0.00', \`climateFactors\` json NULL, \`laborFactors\` json NULL, \`resourceConstraints\` json NULL, \`alertSettings\` json NULL, \`totalScheduleCost\` decimal(15,2) NOT NULL DEFAULT '0.00', \`actualSpentCost\` decimal(15,2) NOT NULL DEFAULT '0.00', \`costVariancePercentage\` decimal(5,2) NOT NULL DEFAULT '0.00', \`baseTemplateId\` varchar(255) NULL, \`isOptimized\` tinyint NOT NULL DEFAULT 0, \`optimizationParameters\` json NULL, \`criticalPath\` json NULL, \`customFields\` json NULL, \`isActive\` tinyint NOT NULL DEFAULT 1, \`createdAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updatedAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), \`projectId\` varchar(255) NOT NULL, \`calculationBudgetId\` varchar(255) NULL, \`project_id\` varchar(36) NULL, \`calculation_budget_id\` varchar(36) NULL, PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`activity_progress\` (\`id\` varchar(36) NOT NULL, \`reportDate\` date NOT NULL, \`progressPercentage\` decimal(5,2) NOT NULL, \`status\` enum ('draft', 'submitted', 'approved', 'rejected') NOT NULL DEFAULT 'submitted', \`workCompleted\` json NOT NULL, \`actualWorkersOnSite\` int NOT NULL DEFAULT '0', \`actualHoursWorked\` decimal(8,2) NOT NULL DEFAULT '0.00', \`plannedHoursForDay\` decimal(8,2) NOT NULL DEFAULT '0.00', \`productivityRate\` decimal(8,4) NULL, \`efficiencyPercentage\` decimal(5,2) NULL, \`weatherConditions\` json NULL, \`qualityIssues\` json NULL, \`safetyIncidents\` json NULL, \`obstacles\` json NULL, \`materialUsage\` json NULL, \`equipmentUsage\` json NULL, \`dailyLaborCost\` decimal(12,2) NULL, \`dailyMaterialCost\` decimal(12,2) NULL, \`dailyEquipmentCost\` decimal(12,2) NULL, \`dailyTotalCost\` decimal(12,2) NULL, \`location\` json NULL, \`photos\` json NULL, \`qualityScore\` decimal(3,1) NULL, \`safetyScore\` decimal(3,1) NULL, \`productivityScore\` decimal(3,1) NULL, \`overallScore\` decimal(3,1) NULL, \`generalComments\` text NULL, \`nextDayPlanning\` text NULL, \`supervisorNotes\` text NULL, \`reportedBy\` varchar(255) NOT NULL, \`approvedBy\` varchar(255) NULL, \`approvedAt\` timestamp NULL, \`rejectionReason\` text NULL, \`customFields\` json NULL, \`isActive\` tinyint NOT NULL DEFAULT 1, \`createdAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updatedAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), \`activityId\` varchar(255) NOT NULL, \`activity_id\` varchar(36) NULL, INDEX \`IDX_61cb7e9895596e65a5121ef095\` (\`status\`), INDEX \`IDX_da33e9e80ac0e767ad6da3890e\` (\`reportDate\`), INDEX \`IDX_2c78487cbf6f9d89f6a2d5115f\` (\`activityId\`, \`reportDate\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`schedule_activities\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NULL, \`status\` enum ('not_started', 'in_progress', 'on_hold', 'completed', 'cancelled', 'delayed', 'rework_required') NOT NULL DEFAULT 'not_started', \`activityType\` enum ('construction', 'installation', 'inspection', 'delivery', 'approval', 'milestone', 'buffer', 'excavation', 'foundation', 'structure', 'masonry', 'roofing', 'electrical', 'plumbing', 'finishing', 'cleanup', 'preparation', 'other') NOT NULL, \`priority\` enum ('low', 'normal', 'high', 'critical') NOT NULL DEFAULT 'normal', \`primaryTrade\` enum ('excavation', 'concrete', 'masonry', 'steel', 'carpentry', 'electrical', 'plumbing', 'painting', 'finishing', 'landscaping', 'welding', 'general') NULL, \`plannedStartDate\` date NOT NULL, \`plannedEndDate\` date NOT NULL, \`plannedDurationDays\` decimal(10,2) NOT NULL, \`actualStartDate\` date NULL, \`actualEndDate\` date NULL, \`actualDurationDays\` decimal(10,2) NOT NULL DEFAULT '0.00', \`earlyStartDate\` date NULL, \`earlyFinishDate\` date NULL, \`lateStartDate\` date NULL, \`lateFinishDate\` date NULL, \`totalFloat\` decimal(10,2) NOT NULL DEFAULT '0.00', \`freeFloat\` decimal(10,2) NOT NULL DEFAULT '0.00', \`progressPercentage\` decimal(5,2) NOT NULL DEFAULT '0.00', \`isCriticalPath\` tinyint NOT NULL DEFAULT 0, \`isMilestone\` tinyint NOT NULL DEFAULT 0, \`workConfiguration\` json NOT NULL, \`workQuantities\` json NOT NULL, \`plannedLaborCost\` decimal(15,2) NOT NULL DEFAULT '0.00', \`plannedMaterialCost\` decimal(15,2) NOT NULL DEFAULT '0.00', \`plannedEquipmentCost\` decimal(15,2) NOT NULL DEFAULT '0.00', \`plannedTotalCost\` decimal(15,2) NOT NULL DEFAULT '0.00', \`actualLaborCost\` decimal(15,2) NOT NULL DEFAULT '0.00', \`actualMaterialCost\` decimal(15,2) NOT NULL DEFAULT '0.00', \`actualEquipmentCost\` decimal(15,2) NOT NULL DEFAULT '0.00', \`actualTotalCost\` decimal(15,2) NOT NULL DEFAULT '0.00', \`predecessors\` json NULL, \`successors\` json NULL, \`alertConfiguration\` json NULL, \`environmentalFactors\` json NULL, \`qualityControl\` json NULL, \`location\` json NULL, \`customFields\` json NULL, \`isActive\` tinyint NOT NULL DEFAULT 1, \`createdAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updatedAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), \`scheduleId\` varchar(255) NOT NULL, \`schedule_id\` varchar(36) NULL, INDEX \`IDX_7dc6c5a72586d87ba01760adff\` (\`isCriticalPath\`), INDEX \`IDX_9d846bf99b24094bd3a7db67ef\` (\`plannedStartDate\`, \`plannedEndDate\`), INDEX \`IDX_2a02c90148b37b5d0b3b883718\` (\`scheduleId\`, \`status\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`equipment\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(100) NOT NULL, \`model\` varchar(100) NULL, \`manufacturer\` varchar(100) NULL, \`brand\` varchar(100) NULL, \`serialNumber\` varchar(50) NULL, \`manufacturingYear\` int NULL, \`equipmentType\` enum ('excavator', 'crane', 'bulldozer', 'mixer', 'truck', 'generator', 'compressor', 'welding_machine', 'drilling_machine', 'scaffolding', 'hand_tools', 'other') NOT NULL, \`status\` enum ('available', 'in_use', 'maintenance', 'out_of_order', 'retired') NOT NULL DEFAULT 'available', \`condition\` enum ('excellent', 'good', 'fair', 'poor', 'critical') NOT NULL DEFAULT 'good', \`isAvailable\` tinyint NOT NULL DEFAULT 1, \`availableFrom\` date NULL, \`availableUntil\` date NULL, \`hourlyRate\` decimal(8,2) NOT NULL, \`dailyRentalCost\` decimal(8,2) NOT NULL, \`hourlyOperatingCost\` decimal(8,2) NOT NULL, \`mobilizationCost\` decimal(10,2) NOT NULL, \`demobilizationCost\` decimal(10,2) NOT NULL, \`purchasePrice\` decimal(10,2) NULL, \`purchaseDate\` date NULL, \`maintenanceCostPerHour\` decimal(8,2) NULL, \`fuelCostPerHour\` decimal(8,2) NULL, \`maxOperatingHoursPerDay\` int NULL, \`totalOperatingHours\` decimal(10,2) NOT NULL DEFAULT '0.00', \`lastMaintenanceDate\` date NULL, \`maintenanceIntervalHours\` int NULL, \`location\` varchar(200) NULL, \`currentLocation\` varchar(200) NULL, \`operator\` varchar(100) NULL, \`geographicalZone\` enum ('quito', 'guayaquil', 'cuenca', 'costa', 'sierra', 'oriente', 'insular') NOT NULL, \`specifications\` json NULL, \`maintenanceSchedule\` json NULL, \`maintenanceHistory\` json NULL, \`certifications\` json NULL, \`safetyFeatures\` json NULL, \`lastSafetyInspection\` date NULL, \`nextSafetyInspection\` date NULL, \`notes\` text NULL, \`ownerId\` varchar(255) NULL, \`customFields\` json NULL, \`createdAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updatedAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`resource_assignments\` (\`id\` varchar(36) NOT NULL, \`resourceType\` enum ('WORKFORCE', 'EQUIPMENT', 'MATERIAL') NOT NULL, \`resourceId\` varchar(255) NULL, \`quantity\` decimal(10,2) NOT NULL DEFAULT '1.00', \`unit\` varchar(50) NOT NULL DEFAULT 'unit', \`allocationPercentage\` decimal(5,2) NOT NULL DEFAULT '100.00', \`assignmentDate\` date NOT NULL, \`startDate\` date NOT NULL, \`endDate\` date NOT NULL, \`plannedStartDate\` date NULL, \`plannedEndDate\` date NULL, \`dailyHours\` decimal(8,2) NOT NULL DEFAULT '8.00', \`status\` enum ('draft', 'assigned', 'active', 'completed', 'cancelled', 'on_hold') NOT NULL DEFAULT 'assigned', \`plannedCost\` decimal(12,2) NULL, \`actualCost\` decimal(12,2) NULL, \`hourlyRate\` decimal(8,2) NULL, \`dailyRate\` decimal(8,2) NULL, \`workConfiguration\` json NULL, \`notes\` text NULL, \`specialRequirements\` text NULL, \`utilizationPercentage\` decimal(5,2) NOT NULL DEFAULT '0.00', \`actualHoursWorked\` decimal(10,2) NOT NULL DEFAULT '0.00', \`plannedHours\` decimal(10,2) NOT NULL DEFAULT '0.00', \`customFields\` json NULL, \`isActive\` tinyint NOT NULL DEFAULT 1, \`createdAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updatedAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), \`activityId\` varchar(255) NOT NULL, \`workforceId\` varchar(255) NULL, \`equipmentId\` varchar(255) NULL, \`materialId\` varchar(255) NULL, \`activity_id\` varchar(36) NULL, \`workforce_id\` varchar(36) NULL, \`equipment_id\` varchar(36) NULL, \`material_id\` varchar(36) NULL, INDEX \`IDX_fad1d33d835ba554471f2f873e\` (\`status\`), INDEX \`IDX_0f84147f30821bcd93268413c8\` (\`assignmentDate\`), INDEX \`IDX_d63157cb19c566c4ebc64cc06e\` (\`activityId\`, \`resourceType\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`workforce\` (\`id\` varchar(36) NOT NULL, \`fullName\` varchar(200) NOT NULL, \`name\` varchar(100) NOT NULL, \`identification\` varchar(50) NULL, \`workerType\` enum ('foreman', 'skilled_worker', 'helper', 'specialist', 'supervisor', 'quality_inspector', 'laborer', 'technician', 'engineer') NOT NULL, \`primaryTrade\` varchar(100) NOT NULL, \`secondaryTrades\` json NULL, \`certificationLevel\` enum ('basic', 'intermediate', 'advanced', 'expert', 'certified') NOT NULL DEFAULT 'basic', \`status\` enum ('available', 'busy', 'on_leave', 'inactive') NOT NULL DEFAULT 'available', \`hourlyRate\` decimal(8,2) NOT NULL, \`overtimeRate\` decimal(8,2) NULL, \`standardWorkingHours\` int NOT NULL DEFAULT '8', \`skillLevel\` varchar(50) NULL, \`specializations\` varchar(200) NULL, \`maxHoursPerDay\` int NOT NULL DEFAULT '8', \`maxHoursPerWeek\` int NOT NULL DEFAULT '40', \`isAvailable\` tinyint NOT NULL DEFAULT 1, \`availableFrom\` date NULL, \`availableUntil\` date NULL, \`productivity\` json NULL, \`productivityFactor\` decimal(3,2) NOT NULL DEFAULT '1.00', \`experienceYears\` int NOT NULL DEFAULT '0', \`geographicalZone\` enum ('quito', 'guayaquil', 'cuenca', 'costa', 'sierra', 'oriente', 'insular') NOT NULL, \`willingToRelocate\` tinyint NOT NULL DEFAULT 0, \`relocationDailyCost\` decimal(8,2) NOT NULL DEFAULT '0.00', \`certifications\` json NULL, \`skills\` json NULL, \`workHistory\` json NULL, \`phone\` varchar(20) NULL, \`email\` varchar(100) NULL, \`address\` text NULL, \`emergencyContact\` json NULL, \`contactInfo\` varchar(100) NULL, \`notes\` text NULL, \`managedById\` varchar(255) NULL, \`customFields\` json NULL, \`createdAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updatedAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`schedule_activity_templates\` (\`id\` varchar(36) NOT NULL, \`scheduleTemplateId\` varchar(255) NOT NULL, \`name\` varchar(200) NOT NULL, \`description\` text NULL, \`type\` enum ('preparation', 'excavation', 'foundation', 'structure', 'masonry', 'roofing', 'electrical', 'plumbing', 'finishing', 'inspection', 'cleanup', 'other') NOT NULL, \`category\` enum ('critical', 'major', 'minor', 'optional') NOT NULL DEFAULT 'major', \`status\` enum ('template', 'draft', 'active', 'completed', 'cancelled') NOT NULL DEFAULT 'template', \`estimatedDurationDays\` int NOT NULL, \`estimatedCost\` decimal(12,2) NULL, \`orderIndex\` int NOT NULL DEFAULT '0', \`predecessors\` json NULL, \`successors\` json NULL, \`requiredResources\` json NULL, \`deliverables\` json NULL, \`qualityChecks\` json NULL, \`bufferPercentage\` decimal(5,2) NOT NULL DEFAULT '0.00', \`dependencies\` json NULL, \`instructions\` text NULL, \`safetyRequirements\` text NULL, \`milestones\` json NULL, \`isCriticalPath\` tinyint NOT NULL DEFAULT 0, \`isActive\` tinyint NOT NULL DEFAULT 1, \`createdAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updatedAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`schedule_templates\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NULL, \`constructionType\` enum ('RESIDENTIAL_SINGLE', 'RESIDENTIAL_MULTI', 'COMMERCIAL_SMALL', 'COMMERCIAL_LARGE', 'INDUSTRIAL', 'INFRASTRUCTURE', 'RENOVATION', 'SPECIALIZED') NOT NULL, \`scope\` enum ('system', 'company', 'personal', 'shared') NOT NULL, \`geographicalZone\` enum ('QUITO', 'GUAYAQUIL', 'CUENCA', 'COSTA', 'SIERRA', 'ORIENTE', 'INSULAR') NOT NULL, \`estimatedDurationDays\` decimal(10,2) NOT NULL, \`phaseConfiguration\` json NOT NULL, \`standardResources\` json NOT NULL, \`geographicalAdjustments\` json NOT NULL, \`activityDependencies\` json NOT NULL, \`performanceMetrics\` json NOT NULL, \`controlConfiguration\` json NOT NULL, \`isVerified\` tinyint NOT NULL DEFAULT 0, \`isActive\` tinyint NOT NULL DEFAULT 1, \`usageCount\` int NOT NULL DEFAULT '0', \`averageRating\` decimal(3,2) NOT NULL DEFAULT '0.00', \`ratingCount\` int NOT NULL DEFAULT '0', \`tags\` json NULL, \`version\` varchar(50) NULL, \`parentTemplateId\` varchar(255) NULL, \`necCompliance\` json NULL, \`customFields\` json NULL, \`createdAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updatedAt\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), \`createdById\` varchar(255) NULL, \`created_by\` varchar(36) NULL, INDEX \`IDX_1dc4122e4da8eb4b1ce266d61e\` (\`usageCount\`), INDEX \`IDX_e080cf9ea4488f0230191c6029\` (\`scope\`, \`isVerified\`), INDEX \`IDX_cdfd67d0daa352b589e1be4e1b\` (\`constructionType\`, \`geographicalZone\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`professional_costs\` (\`id\` varchar(36) NOT NULL, \`calculation_budget_id\` varchar(255) NOT NULL, \`service\` enum ('architectural_design', 'structural_design', 'electrical_design', 'mechanical_design', 'plumbing_design', 'construction_supervision', 'project_management', 'specialty_consultation', 'permits_processing', 'quality_control') NOT NULL, \`description\` varchar(255) NOT NULL, \`complexityLevel\` enum ('basic', 'intermediate', 'advanced', 'complex') NOT NULL, \`cost_type\` varchar(50) NOT NULL, \`type\` varchar(50) NOT NULL, \`amount\` decimal(12,2) NOT NULL, \`percentage\` decimal(5,2) NOT NULL, \`based_on_amount\` decimal(12,2) NULL, \`base_percentage\` decimal(5,3) NOT NULL, \`fixed_amount\` decimal(12,2) NOT NULL DEFAULT '0.00', \`hourly_rate\` decimal(8,2) NULL, \`estimated_hours\` decimal(8,2) NULL, \`complexity_multiplier\` decimal(5,3) NOT NULL DEFAULT '1.000', \`calculated_amount\` decimal(12,2) NOT NULL, \`professional_id\` varchar(255) NULL, \`professional_name\` varchar(255) NULL, \`professional_registration\` varchar(255) NULL, \`professional_speciality\` varchar(255) NULL, \`ecuadorianRegulation\` json NULL, \`includes_taxes\` tinyint NOT NULL DEFAULT 1, \`tax_percentage\` decimal(5,2) NOT NULL DEFAULT '15.00', \`is_approved\` tinyint NOT NULL DEFAULT 0, \`approval_date\` datetime NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), INDEX \`IDX_prof_cost_service\` (\`service\`), INDEX \`IDX_prof_cost_budget\` (\`calculation_budget_id\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`ALTER TABLE \`materials\` ADD \`currentPrice\` decimal(10,2) NULL`);
        await queryRunner.query(`ALTER TABLE \`materials\` ADD \`unitCost\` decimal(10,2) NULL`);
        await queryRunner.query(`ALTER TABLE \`materials\` ADD \`available_quantity\` int NOT NULL DEFAULT '0'`);
        await queryRunner.query(`ALTER TABLE \`materials\` ADD \`external_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`materials\` ADD \`supplier_code\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`materials\` ADD \`last_price_update\` datetime NULL`);
        await queryRunner.query(`ALTER TABLE \`materials\` ADD \`last_inventory_update\` datetime NULL`);
        await queryRunner.query(`ALTER TABLE \`materials\` ADD \`type\` varchar(100) NULL`);
        await queryRunner.query(`ALTER TABLE \`materials\` ADD \`supplierInfo\` json NULL COMMENT 'Información del proveedor'`);
        await queryRunner.query(`ALTER TABLE \`user_addresses\` CHANGE \`reference\` \`reference\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` DROP FOREIGN KEY \`FK_4f0f50d9922a0ed51c214f5556b\``);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`phone\` \`phone\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`mobile_phone\` \`mobile_phone\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`date_of_birth\` \`date_of_birth\` date NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`national_id\` \`national_id\` varchar(255) NULL COMMENT 'Cédula o RUC'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`gender\` \`gender\` enum ('male', 'female', 'other', 'prefer_not_to_say') NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`profile_picture\` \`profile_picture\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`professional_type\` \`professional_type\` enum ('architect', 'civil_engineer', 'constructor', 'contractor', 'electrician', 'plumber', 'designer', 'other') NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`specializations\` \`specializations\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`years_of_experience\` \`years_of_experience\` int NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`education_level\` \`education_level\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`certifications\` \`certifications\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`bio\` \`bio\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`subscription_expires_at\` \`subscription_expires_at\` datetime NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` DROP COLUMN \`company\``);
        await queryRunner.query(`ALTER TABLE \`users\` ADD \`company\` json NULL COMMENT 'Información de la empresa del usuario'`);
        await queryRunner.query(`ALTER TABLE \`users\` DROP COLUMN \`preferences\``);
        await queryRunner.query(`ALTER TABLE \`users\` ADD \`preferences\` json NULL COMMENT 'Preferencias del usuario'`);
        await queryRunner.query(`ALTER TABLE \`users\` DROP COLUMN \`stats\``);
        await queryRunner.query(`ALTER TABLE \`users\` ADD \`stats\` json NULL COMMENT 'Estadísticas del usuario'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`interests\` \`interests\` text NULL COMMENT 'Intereses del usuario para recomendaciones'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`referral_code\` \`referral_code\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`referred_by\` \`referred_by\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` DROP COLUMN \`socialLinks\``);
        await queryRunner.query(`ALTER TABLE \`users\` ADD \`socialLinks\` json NULL COMMENT 'Links a redes sociales'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`verification_token\` \`verification_token\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`password_reset_token\` \`password_reset_token\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`password_reset_expires\` \`password_reset_expires\` datetime NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`admin_id\` \`admin_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`two_factor_secret\` \`two_factor_secret\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`recovery_codes\` \`recovery_codes\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`location\` \`location\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`deleted_at\` \`deleted_at\` datetime(6) NULL`);
        await queryRunner.query(`ALTER TABLE \`categories\` DROP FOREIGN KEY \`FK_88cea2dc9c31951d06437879b40\``);
        await queryRunner.query(`ALTER TABLE \`categories\` CHANGE \`description\` \`description\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`categories\` CHANGE \`icon\` \`icon\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`categories\` CHANGE \`image_url\` \`image_url\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`categories\` CHANGE \`parent_id\` \`parent_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`categories\` CHANGE \`deleted_at\` \`deleted_at\` datetime(6) NULL`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`description\` \`description\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`specifications\` \`specifications\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`wholesale_price\` \`wholesale_price\` decimal(10,2) NULL`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`wholesale_min_quantity\` \`wholesale_min_quantity\` int NULL`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`brand\` \`brand\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`model\` \`model\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`sku\` \`sku\` varchar(255) NULL COMMENT 'Código único de producto'`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`barcode\` \`barcode\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`image_urls\` \`image_urls\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`materials\` DROP COLUMN \`dimensions\``);
        await queryRunner.query(`ALTER TABLE \`materials\` ADD \`dimensions\` json NULL COMMENT 'Dimensiones (largo, ancho, alto, peso)'`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`tags\` \`tags\` text NULL COMMENT 'Etiquetas para búsqueda y categorización'`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`deleted_at\` \`deleted_at\` datetime(6) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_requests\` DROP FOREIGN KEY \`FK_0841476ce9e40a2604e4d68b022\``);
        await queryRunner.query(`ALTER TABLE \`material_requests\` DROP FOREIGN KEY \`FK_e31033962dc07b8d84a5b7ecb04\``);
        await queryRunner.query(`ALTER TABLE \`material_requests\` DROP FOREIGN KEY \`FK_7a37fb09c5fc8cb685d91ef7e77\``);
        await queryRunner.query(`ALTER TABLE \`material_requests\` CHANGE \`notes\` \`notes\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_requests\` CHANGE \`deleted_at\` \`deleted_at\` datetime(6) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_requests\` CHANGE \`taskId\` \`taskId\` varchar(36) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_requests\` CHANGE \`materialId\` \`materialId\` varchar(36) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_requests\` CHANGE \`requesterId\` \`requesterId\` varchar(36) NULL`);
        await queryRunner.query(`ALTER TABLE \`tasks\` DROP FOREIGN KEY \`FK_2687b3eaf84c102e4704b294d10\``);
        await queryRunner.query(`ALTER TABLE \`tasks\` DROP FOREIGN KEY \`FK_9a16d2c86252529f622fa53f1e3\``);
        await queryRunner.query(`ALTER TABLE \`tasks\` CHANGE \`description\` \`description\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`tasks\` CHANGE \`start_date\` \`start_date\` date NULL`);
        await queryRunner.query(`ALTER TABLE \`tasks\` CHANGE \`end_date\` \`end_date\` date NULL`);
        await queryRunner.query(`ALTER TABLE \`tasks\` CHANGE \`assigned_to\` \`assigned_to\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`tasks\` CHANGE \`deleted_at\` \`deleted_at\` datetime(6) NULL`);
        await queryRunner.query(`ALTER TABLE \`tasks\` CHANGE \`phaseId\` \`phaseId\` varchar(36) NULL`);
        await queryRunner.query(`ALTER TABLE \`tasks\` CHANGE \`assigneeId\` \`assigneeId\` varchar(36) NULL`);
        await queryRunner.query(`ALTER TABLE \`phases\` DROP FOREIGN KEY \`FK_5cc8558954b6360a5b7fb5f45fa\``);
        await queryRunner.query(`ALTER TABLE \`phases\` CHANGE \`description\` \`description\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`phases\` CHANGE \`end_date\` \`end_date\` date NULL`);
        await queryRunner.query(`ALTER TABLE \`phases\` CHANGE \`deleted_at\` \`deleted_at\` datetime(6) NULL`);
        await queryRunner.query(`ALTER TABLE \`phases\` CHANGE \`projectId\` \`projectId\` varchar(36) NULL`);
        await queryRunner.query(`ALTER TABLE \`project_documents\` CHANGE \`description\` \`description\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`budget_items\` DROP FOREIGN KEY \`FK_ec3099cfe554eeff19bf6fbb952\``);
        await queryRunner.query(`ALTER TABLE \`budget_items\` CHANGE \`category\` \`category\` varchar(255) NULL COMMENT 'Categoría del ítem (materiales, mano de obra, etc.)'`);
        await queryRunner.query(`ALTER TABLE \`budget_items\` CHANGE \`material_id\` \`material_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`project_budgets\` CHANGE \`description\` \`description\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`project_team_members\` CHANGE \`responsibilities\` \`responsibilities\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`project_team_members\` CHANGE \`hourly_rate\` \`hourly_rate\` decimal(10,2) NULL`);
        await queryRunner.query(`ALTER TABLE \`project_team_members\` CHANGE \`allocated_hours\` \`allocated_hours\` int NULL`);
        await queryRunner.query(`ALTER TABLE \`project_team_members\` CHANGE \`start_date\` \`start_date\` date NULL`);
        await queryRunner.query(`ALTER TABLE \`project_team_members\` CHANGE \`end_date\` \`end_date\` date NULL`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`description\` \`description\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`type\` \`type\` enum ('residential', 'commercial', 'industrial', 'infrastructure', 'remodeling', 'maintenance', 'other') NULL`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`client_name\` \`client_name\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`client_email\` \`client_email\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`client_phone\` \`client_phone\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`end_date\` \`end_date\` date NULL`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`estimated_completion_date\` \`estimated_completion_date\` date NULL`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`total_area\` \`total_area\` decimal(10,2) NULL COMMENT 'Área total en metros cuadrados'`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`construction_area\` \`construction_area\` decimal(10,2) NULL COMMENT 'Área de construcción en metros cuadrados'`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`floors\` \`floors\` int NULL COMMENT 'Número de pisos'`);
        await queryRunner.query(`ALTER TABLE \`projects\` DROP COLUMN \`location\``);
        await queryRunner.query(`ALTER TABLE \`projects\` ADD \`location\` json NULL COMMENT 'Coordenadas de ubicación'`);
        await queryRunner.query(`ALTER TABLE \`projects\` DROP COLUMN \`permits\``);
        await queryRunner.query(`ALTER TABLE \`projects\` ADD \`permits\` json NULL COMMENT 'Permisos y licencias'`);
        await queryRunner.query(`ALTER TABLE \`projects\` DROP COLUMN \`tags\``);
        await queryRunner.query(`ALTER TABLE \`projects\` ADD \`tags\` json NULL COMMENT 'Etiquetas para categorización'`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`estimatedBudget\` \`estimatedBudget\` decimal(12,2) NULL COMMENT 'Presupuesto total estimado'`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`currentCost\` \`currentCost\` decimal(12,2) NULL COMMENT 'Costo total actual'`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`deleted_at\` \`deleted_at\` datetime(6) NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` CHANGE \`default_value\` \`default_value\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` CHANGE \`min_value\` \`min_value\` float NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` CHANGE \`max_value\` \`max_value\` float NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` CHANGE \`regex_pattern\` \`regex_pattern\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` CHANGE \`unit_of_measure\` \`unit_of_measure\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` CHANGE \`allowed_values\` \`allowed_values\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` CHANGE \`help_text\` \`help_text\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` CHANGE \`depends_on_parameters\` \`depends_on_parameters\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` CHANGE \`formula\` \`formula\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` DROP FOREIGN KEY \`FK_8dafddecd6032a3c7f93152c546\``);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` DROP FOREIGN KEY \`FK_c00f2503acc369fff5d14531c3d\``);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` CHANGE \`nec_reference\` \`nec_reference\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` CHANGE \`parent_template_id\` \`parent_template_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` CHANGE \`created_by\` \`created_by\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` CHANGE \`verified_by\` \`verified_by\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` CHANGE \`verified_at\` \`verified_at\` datetime NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` DROP COLUMN \`tags\``);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` ADD \`tags\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` DROP FOREIGN KEY \`FK_853f129c2e18714b20ae9871d25\``);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` CHANGE \`project_id\` \`project_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` CHANGE \`name\` \`name\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` CHANGE \`notes\` \`notes\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` CHANGE \`execution_time_ms\` \`execution_time_ms\` int NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` CHANGE \`error_message\` \`error_message\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` DROP FOREIGN KEY \`FK_50ed9ad3bb787a81b392954b64c\``);
        await queryRunner.query(`DROP INDEX \`IDX_usage_log_period\` ON \`user_template_usage_logs\``);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` CHANGE \`project_id\` \`project_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` CHANGE \`usage_date\` \`usage_date\` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` CHANGE \`ip_address\` \`ip_address\` varchar(45) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` CHANGE \`user_agent\` \`user_agent\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` DROP COLUMN \`input_parameters\``);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` ADD \`input_parameters\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` DROP COLUMN \`output_results\``);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` ADD \`output_results\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` CHANGE \`error_message\` \`error_message\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage\` DROP FOREIGN KEY \`FK_1040ea5eb6a7bc8f68f5aca6856\``);
        await queryRunner.query(`ALTER TABLE \`user_template_usage\` CHANGE \`project_id\` \`project_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage\` CHANGE \`average_completion_time_ms\` \`average_completion_time_ms\` int NULL`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage\` CHANGE \`average_calculation_time_ms\` \`average_calculation_time_ms\` int NULL`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage\` CHANGE \`user_rating\` \`user_rating\` decimal(3,2) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` DROP FOREIGN KEY \`FK_7d269f828eae70d35bffc315669\``);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` DROP FOREIGN KEY \`FK_b1efb9ee932ba7548dbab94754f\``);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` DROP FOREIGN KEY \`FK_77a611a071acaa0cf60c3fcebc1\``);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` CHANGE \`material_id\` \`material_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` CHANGE \`category_id\` \`category_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` CHANGE \`project_type\` \`project_type\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` CHANGE \`supplier_id\` \`supplier_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` CHANGE \`reason\` \`reason\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` CHANGE \`expires_at\` \`expires_at\` datetime NULL`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` DROP FOREIGN KEY \`FK_fc77d2e4b067b8d186a1e3a3806\``);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` DROP FOREIGN KEY \`FK_06b9bdc564bab6c33c92c4f7cc0\``);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` CHANGE \`default_value\` \`default_value\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` CHANGE \`min_value\` \`min_value\` float NULL`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` CHANGE \`max_value\` \`max_value\` float NULL`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` CHANGE \`unit\` \`unit\` enum ('m2', 'm3', 'ml', 'units', 'kg', 'bags', 'sheets') NULL`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` CHANGE \`allowedValues\` \`allowedValues\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` CHANGE \`help_text\` \`help_text\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` CHANGE \`depends_on_parameters\` \`depends_on_parameters\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` CHANGE \`material_calculation_template_id\` \`material_calculation_template_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` CHANGE \`user_material_calculation_template_id\` \`user_material_calculation_template_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_templates\` DROP FOREIGN KEY \`FK_51c1a31afa659d89c3457010368\``);
        await queryRunner.query(`ALTER TABLE \`material_calculation_templates\` DROP COLUMN \`regionalFactors\``);
        await queryRunner.query(`ALTER TABLE \`material_calculation_templates\` ADD \`regionalFactors\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_templates\` CHANGE \`normative_reference\` \`normative_reference\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_templates\` CHANGE \`created_by\` \`created_by\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_templates\` CHANGE \`tags\` \`tags\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`user_material_calculation_templates\` DROP FOREIGN KEY \`FK_08e6b8ce6b2e94be1e50bff48b6\``);
        await queryRunner.query(`ALTER TABLE \`user_material_calculation_templates\` CHANGE \`base_template_id\` \`base_template_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_material_calculation_templates\` CHANGE \`tags\` \`tags\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` DROP FOREIGN KEY \`FK_14047a1c98dc98ce5b95d897110\``);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` DROP FOREIGN KEY \`FK_7a2b54d9d51d59f9a5ac3903145\``);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` DROP FOREIGN KEY \`FK_e54cbc691fe8044c9f63eec86bb\``);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` CHANGE \`material_id\` \`material_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` CHANGE \`category_id\` \`category_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` CHANGE \`project_id\` \`project_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` CHANGE \`search_query\` \`search_query\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` DROP COLUMN \`metadata\``);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` ADD \`metadata\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` CHANGE \`session_id\` \`session_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` CHANGE \`ip_address\` \`ip_address\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` CHANGE \`user_agent\` \`user_agent\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` DROP FOREIGN KEY \`FK_cbb26d53c21e1dfb5de9b395ab6\``);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` DROP FOREIGN KEY \`FK_5a088977c3e95dbd185a356b4d0\``);
        await queryRunner.query(`DROP INDEX \`IDX_user_templates_source\` ON \`user_calculation_templates\``);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` CHANGE \`long_description\` \`long_description\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` CHANGE \`original_template_id\` \`original_template_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` CHANGE \`source_calculation_result_id\` \`source_calculation_result_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` CHANGE \`subcategory\` \`subcategory\` varchar(50) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` CHANGE \`estimated_time\` \`estimated_time\` varchar(50) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` CHANGE \`nec_reference\` \`nec_reference\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` DROP COLUMN \`tags\``);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` ADD \`tags\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` DROP COLUMN \`requirements\``);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` ADD \`requirements\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` DROP COLUMN \`application_cases\``);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` ADD \`application_cases\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` DROP COLUMN \`limitations\``);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` ADD \`limitations\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` DROP COLUMN \`shared_with\``);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` ADD \`shared_with\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` DROP COLUMN \`contributors\``);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` ADD \`contributors\` json NULL`);
        await queryRunner.query(`DROP INDEX \`IDX_trending_calculations_period_rank\` ON \`trending_calculations\``);
        await queryRunner.query(`ALTER TABLE \`trending_calculations\` CHANGE \`rank_position\` \`rank_position\` int NULL`);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` DROP FOREIGN KEY \`FK_dbe2c5d0c3b4f2b1668a1c0a6fb\``);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` CHANGE \`current_value\` \`current_value\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` CHANGE \`proposed_value\` \`proposed_value\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` CHANGE \`justification\` \`justification\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` DROP COLUMN \`references\``);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` ADD \`references\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` CHANGE \`reviewed_by\` \`reviewed_by\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` CHANGE \`reviewed_at\` \`reviewed_at\` datetime NULL`);
        await queryRunner.query(`ALTER TABLE \`template_ratings\` CHANGE \`comment\` \`comment\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` DROP FOREIGN KEY \`FK_9d9a16ba84129d20dd53ea77882\``);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` DROP FOREIGN KEY \`FK_a3785bcbb47694708263e0c33a8\``);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` CHANGE \`detailed_justification\` \`detailed_justification\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` CHANGE \`reviewed_by\` \`reviewed_by\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` CHANGE \`reviewed_at\` \`reviewed_at\` timestamp NULL`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` CHANGE \`review_comments\` \`review_comments\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` CHANGE \`verified_template_id\` \`verified_template_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` DROP COLUMN \`estimated_impact\``);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` ADD \`estimated_impact\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` DROP COLUMN \`approval_workflow\``);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` ADD \`approval_workflow\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` CHANGE \`implementation_notes\` \`implementation_notes\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` CHANGE \`quality_score\` \`quality_score\` decimal(3,2) NULL`);
        await queryRunner.query(`ALTER TABLE \`orders\` CHANGE \`notes\` \`notes\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`orders\` CHANGE \`estimated_delivery_date\` \`estimated_delivery_date\` date NULL`);
        await queryRunner.query(`ALTER TABLE \`orders\` CHANGE \`actual_delivery_date\` \`actual_delivery_date\` date NULL`);
        await queryRunner.query(`ALTER TABLE \`orders\` DROP COLUMN \`tracking_info\``);
        await queryRunner.query(`ALTER TABLE \`orders\` ADD \`tracking_info\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`order_items\` DROP FOREIGN KEY \`FK_a21e9d18e98c6f9f489a75027d4\``);
        await queryRunner.query(`ALTER TABLE \`order_items\` CHANGE \`material_request_id\` \`material_request_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`order_items\` CHANGE \`notes\` \`notes\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`notifications\` CHANGE \`type\` \`type\` enum ('price_change', 'project_delay', 'material_request', 'task_assignment', 'document_upload', 'payment_due', 'inventory_low', 'calculation_complete', 'system_announcement', 'budget_approval', 'price_update', 'material_import', 'info', 'warning', 'error', 'success', 'system', 'budget_update', 'price_alert') NOT NULL`);
        await queryRunner.query(`ALTER TABLE \`notifications\` CHANGE \`read_at\` \`read_at\` datetime NULL`);
        await queryRunner.query(`ALTER TABLE \`notifications\` CHANGE \`action_url\` \`action_url\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`notifications\` CHANGE \`action_text\` \`action_text\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`notifications\` CHANGE \`related_entity_type\` \`related_entity_type\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`notifications\` CHANGE \`related_entity_id\` \`related_entity_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`notifications\` CHANGE \`expires_at\` \`expires_at\` datetime NULL`);
        await queryRunner.query(`ALTER TABLE \`notifications\` CHANGE \`icon\` \`icon\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_results\` CHANGE \`project_id\` \`project_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_results\` CHANGE \`total_cost\` \`total_cost\` decimal(12,2) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_results\` CHANGE \`currency\` \`currency\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_results\` CHANGE \`notes\` \`notes\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`material_template_usage_logs\` CHANGE \`project_id\` \`project_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_template_usage_logs\` CHANGE \`total_cost\` \`total_cost\` decimal(12,2) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_template_usage_logs\` CHANGE \`ip_address\` \`ip_address\` varchar(45) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_template_usage_logs\` CHANGE \`user_agent\` \`user_agent\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`material_property_definitions\` CHANGE \`description\` \`description\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`material_property_definitions\` DROP COLUMN \`options\``);
        await queryRunner.query(`ALTER TABLE \`material_property_definitions\` ADD \`options\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`material_property_values\` CHANGE \`text_value\` \`text_value\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`material_property_values\` CHANGE \`number_value\` \`number_value\` decimal(18,6) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_property_values\` CHANGE \`boolean_value\` \`boolean_value\` tinyint NULL`);
        await queryRunner.query(`ALTER TABLE \`material_property_values\` CHANGE \`date_value\` \`date_value\` datetime NULL`);
        await queryRunner.query(`ALTER TABLE \`material_property_values\` CHANGE \`array_value\` \`array_value\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`material_property_values\` DROP COLUMN \`json_value\``);
        await queryRunner.query(`ALTER TABLE \`material_property_values\` ADD \`json_value\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` DROP FOREIGN KEY \`FK_a968dc1f591174a862e947a099a\``);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` CHANGE \`wholesale_price\` \`wholesale_price\` decimal(10,2) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` CHANGE \`wholesale_min_quantity\` \`wholesale_min_quantity\` int NULL`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` CHANGE \`end_date\` \`end_date\` date NULL`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` CHANGE \`reason\` \`reason\` enum ('supplier_update', 'market_fluctuation', 'promotion', 'seasonal_change', 'inflation_adjustment', 'bulk_discount', 'other') NULL`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` CHANGE \`notes\` \`notes\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` CHANGE \`supplier_name\` \`supplier_name\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` CHANGE \`supplier_id\` \`supplier_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` CHANGE \`price_change_percentage\` \`price_change_percentage\` decimal(5,2) NULL`);
        await queryRunner.query(`ALTER TABLE \`invoices\` DROP FOREIGN KEY \`FK_9ba18dbe4ea525518c4b32df4b6\``);
        await queryRunner.query(`ALTER TABLE \`invoices\` CHANGE \`payment_method\` \`payment_method\` enum ('cash', 'bank_transfer', 'credit_card', 'debit_card', 'check', 'paypal', 'other') NULL`);
        await queryRunner.query(`ALTER TABLE \`invoices\` CHANGE \`payment_reference\` \`payment_reference\` varchar(255) NULL COMMENT 'Número de transacción, cheque, etc.'`);
        await queryRunner.query(`ALTER TABLE \`invoices\` CHANGE \`payment_date\` \`payment_date\` date NULL`);
        await queryRunner.query(`ALTER TABLE \`invoices\` CHANGE \`sri_authorization\` \`sri_authorization\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`invoices\` CHANGE \`sri_access_key\` \`sri_access_key\` varchar(255) NULL COMMENT 'Clave de acceso SRI (para facturación electrónica)'`);
        await queryRunner.query(`ALTER TABLE \`invoices\` CHANGE \`electronic_invoice_url\` \`electronic_invoice_url\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`invoices\` CHANGE \`notes\` \`notes\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`invoices\` CHANGE \`project_id\` \`project_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`invoices\` CHANGE \`deleted_at\` \`deleted_at\` datetime(6) NULL`);
        await queryRunner.query(`ALTER TABLE \`invoice_items\` DROP FOREIGN KEY \`FK_7fb6895fc8fad9f5200e91abb59\``);
        await queryRunner.query(`ALTER TABLE \`invoice_items\` DROP FOREIGN KEY \`FK_f57d843bb46a121d4ebc9722bda\``);
        await queryRunner.query(`ALTER TABLE \`invoice_items\` CHANGE \`material_id\` \`material_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`invoice_items\` CHANGE \`invoiceId\` \`invoiceId\` varchar(36) NULL`);
        await queryRunner.query(`ALTER TABLE \`invoice_items\` CHANGE \`materialId\` \`materialId\` varchar(36) NULL`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` CHANGE \`description\` \`description\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` CHANGE \`parent_zone_id\` \`parent_zone_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` CHANGE \`default_soil_type\` \`default_soil_type\` enum ('type_a', 'type_b', 'type_c', 'type_d', 'type_e', 'type_f') NULL`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` CHANGE \`elevation\` \`elevation\` int NULL`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` CHANGE \`climate_zone\` \`climate_zone\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` CHANGE \`wind_speed\` \`wind_speed\` decimal(5,2) NULL`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` CHANGE \`rainfall_intensity\` \`rainfall_intensity\` decimal(5,2) NULL`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` CHANGE \`snow_load\` \`snow_load\` decimal(5,2) NULL`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` DROP COLUMN \`location_coordinates\``);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` ADD \`location_coordinates\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` CHANGE \`nec_reference\` \`nec_reference\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` DROP FOREIGN KEY \`FK_85d7e3a9cb392c44061e730bf28\``);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` DROP FOREIGN KEY \`FK_282e0117b2315610a378e7afc08\``);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` CHANGE \`project_id\` \`project_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` CHANGE \`trigger_template_id\` \`trigger_template_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` CHANGE \`clicked_at\` \`clicked_at\` datetime NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` DROP FOREIGN KEY \`FK_6ed14207fe2755c8d2530824eeb\``);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` DROP FOREIGN KEY \`FK_51b6edc66f271d96867617f04a9\``);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` CHANGE \`calculation_result_id\` \`calculation_result_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` CHANGE \`rating\` \`rating\` decimal(3,2) NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` CHANGE \`comment\` \`comment\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` DROP COLUMN \`suggestionDetails\``);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` ADD \`suggestionDetails\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` CHANGE \`applied_to_template_id\` \`applied_to_template_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` CHANGE \`reviewed_by\` \`reviewed_by\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` DROP FOREIGN KEY \`FK_043809e28ff744481f88690fcc4\``);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` DROP FOREIGN KEY \`FK_16b423eef8496fd15c5a550e726\``);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` CHANGE \`improved_template_id\` \`improved_template_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` CHANGE \`reviewed_by\` \`reviewed_by\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` CHANGE \`feedback_ids\` \`feedback_ids\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` DROP COLUMN \`dataAnalysis\``);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` ADD \`dataAnalysis\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_guides\` CHANGE \`images\` \`images\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_guides\` CHANGE \`video_url\` \`video_url\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_comparisons\` CHANGE \`description\` \`description\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`calculation_comparisons\` DROP COLUMN \`comparison_data\``);
        await queryRunner.query(`ALTER TABLE \`calculation_comparisons\` ADD \`comparison_data\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`custom_attribution\` \`custom_attribution\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`contribution_description\` \`contribution_description\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`contribution_percentage\` \`contribution_percentage\` decimal(5,2) NULL`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`original_creation_date\` \`original_creation_date\` timestamp NULL`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`promotion_date\` \`promotion_date\` timestamp NULL`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`promotion_request_id\` \`promotion_request_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` DROP COLUMN \`metrics_at_promotion\``);
        await queryRunner.query(`ALTER TABLE \`author_credits\` ADD \`metrics_at_promotion\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`badge_earned\` \`badge_earned\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`recognition_level\` \`recognition_level\` enum ('bronze', 'silver', 'gold', 'platinum') NULL`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`approved_by\` \`approved_by\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`approved_at\` \`approved_at\` timestamp NULL`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`approval_notes\` \`approval_notes\` text NULL`);
        await queryRunner.query(`ALTER TABLE \`accounting_transactions\` CHANGE \`external_id\` \`external_id\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`accounting_transactions\` CHANGE \`account_code\` \`account_code\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`accounting_transactions\` CHANGE \`accounting_system\` \`accounting_system\` varchar(255) NULL`);
        await queryRunner.query(`ALTER TABLE \`accounting_transactions\` DROP COLUMN \`metadata\``);
        await queryRunner.query(`ALTER TABLE \`accounting_transactions\` ADD \`metadata\` json NULL`);
        await queryRunner.query(`ALTER TABLE \`accounting_transactions\` CHANGE \`error_message\` \`error_message\` text NULL`);
        await queryRunner.query(`CREATE INDEX \`IDX_usage_log_period\` ON \`user_template_usage_logs\` (\`template_id\`, \`template_type\`, \`usage_date\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_user_templates_source\` ON \`user_calculation_templates\` (\`source_type\`, \`original_template_id\`)`);
        await queryRunner.query(`CREATE INDEX \`IDX_trending_calculations_period_rank\` ON \`trending_calculations\` (\`period\`, \`rank_position\`)`);
        await queryRunner.query(`ALTER TABLE \`users\` ADD CONSTRAINT \`FK_4f0f50d9922a0ed51c214f5556b\` FOREIGN KEY (\`admin_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`categories\` ADD CONSTRAINT \`FK_88cea2dc9c31951d06437879b40\` FOREIGN KEY (\`parent_id\`) REFERENCES \`categories\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_requests\` ADD CONSTRAINT \`FK_0841476ce9e40a2604e4d68b022\` FOREIGN KEY (\`taskId\`) REFERENCES \`tasks\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_requests\` ADD CONSTRAINT \`FK_e31033962dc07b8d84a5b7ecb04\` FOREIGN KEY (\`materialId\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_requests\` ADD CONSTRAINT \`FK_7a37fb09c5fc8cb685d91ef7e77\` FOREIGN KEY (\`requesterId\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`tasks\` ADD CONSTRAINT \`FK_2687b3eaf84c102e4704b294d10\` FOREIGN KEY (\`phaseId\`) REFERENCES \`phases\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`tasks\` ADD CONSTRAINT \`FK_9a16d2c86252529f622fa53f1e3\` FOREIGN KEY (\`assigneeId\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`phases\` ADD CONSTRAINT \`FK_5cc8558954b6360a5b7fb5f45fa\` FOREIGN KEY (\`projectId\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`budget_items\` ADD CONSTRAINT \`FK_ec3099cfe554eeff19bf6fbb952\` FOREIGN KEY (\`material_id\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` ADD CONSTRAINT \`FK_8dafddecd6032a3c7f93152c546\` FOREIGN KEY (\`parent_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` ADD CONSTRAINT \`FK_c00f2503acc369fff5d14531c3d\` FOREIGN KEY (\`created_by\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` ADD CONSTRAINT \`FK_853f129c2e18714b20ae9871d25\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`budget_templates\` ADD CONSTRAINT \`FK_5050bf78898cb0b281db86a4c41\` FOREIGN KEY (\`createdBy\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`budget_line_items\` ADD CONSTRAINT \`FK_537e6164fe2a639937944cb091e\` FOREIGN KEY (\`calculation_budget_id\`) REFERENCES \`calculation_budgets\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`budget_line_items\` ADD CONSTRAINT \`FK_a4a8e27d213c1e558564dab2381\` FOREIGN KEY (\`material_id\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_budgets\` ADD CONSTRAINT \`FK_c8eb229b61622c1ab6f8b7263b8\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_budgets\` ADD CONSTRAINT \`FK_2e34c1bebebb6d8469b310852ba\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_budgets\` ADD CONSTRAINT \`FK_8ad93f7cb9c1cd3df35e27d313d\` FOREIGN KEY (\`calculation_result_id\`) REFERENCES \`calculation_results\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_budgets\` ADD CONSTRAINT \`FK_10e29d5e2eeef0638da230b8331\` FOREIGN KEY (\`budget_template_id\`) REFERENCES \`budget_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`progress_tracking\` ADD CONSTRAINT \`FK_2bfff54d7f1482535da8aca9feb\` FOREIGN KEY (\`schedule_id\`) REFERENCES \`calculation_schedules\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`progress_tracking\` ADD CONSTRAINT \`FK_338f163a05c4fbccaf8706fe91a\` FOREIGN KEY (\`reported_by\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`progress_tracking\` ADD CONSTRAINT \`FK_9db7e81bf10b079fc816dccb581\` FOREIGN KEY (\`approved_by\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`weather_factors\` ADD CONSTRAINT \`FK_b9f38701cbc66f208f61b013124\` FOREIGN KEY (\`schedule_id\`) REFERENCES \`calculation_schedules\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_schedules\` ADD CONSTRAINT \`FK_6a7202f312caac7ede7efcf3022\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_schedules\` ADD CONSTRAINT \`FK_aebbbfc08784dfa941a708a1165\` FOREIGN KEY (\`calculation_budget_id\`) REFERENCES \`calculation_budgets\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`activity_progress\` ADD CONSTRAINT \`FK_63f1159a898c208f25b7d172c4c\` FOREIGN KEY (\`activity_id\`) REFERENCES \`schedule_activities\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`schedule_activities\` ADD CONSTRAINT \`FK_16031ba9d12734e1078b247f3f1\` FOREIGN KEY (\`schedule_id\`) REFERENCES \`calculation_schedules\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`equipment\` ADD CONSTRAINT \`FK_8c675a8a1fb7097c17e3280d1df\` FOREIGN KEY (\`ownerId\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`resource_assignments\` ADD CONSTRAINT \`FK_979f24ea6e4b24cbbdee33dc376\` FOREIGN KEY (\`activity_id\`) REFERENCES \`schedule_activities\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`resource_assignments\` ADD CONSTRAINT \`FK_cc91428297972daf501d7daab24\` FOREIGN KEY (\`workforce_id\`) REFERENCES \`workforce\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`resource_assignments\` ADD CONSTRAINT \`FK_010e78e3b02ee92d729928c2fc6\` FOREIGN KEY (\`equipment_id\`) REFERENCES \`equipment\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`resource_assignments\` ADD CONSTRAINT \`FK_b0a087f02461ad2dc118d3cf2b8\` FOREIGN KEY (\`material_id\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`workforce\` ADD CONSTRAINT \`FK_f05884dc0616f0771c08529b0a7\` FOREIGN KEY (\`managedById\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` ADD CONSTRAINT \`FK_50ed9ad3bb787a81b392954b64c\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage\` ADD CONSTRAINT \`FK_1040ea5eb6a7bc8f68f5aca6856\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` ADD CONSTRAINT \`FK_7d269f828eae70d35bffc315669\` FOREIGN KEY (\`material_id\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` ADD CONSTRAINT \`FK_b1efb9ee932ba7548dbab94754f\` FOREIGN KEY (\`category_id\`) REFERENCES \`categories\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` ADD CONSTRAINT \`FK_77a611a071acaa0cf60c3fcebc1\` FOREIGN KEY (\`supplier_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` ADD CONSTRAINT \`FK_fc77d2e4b067b8d186a1e3a3806\` FOREIGN KEY (\`material_calculation_template_id\`) REFERENCES \`material_calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` ADD CONSTRAINT \`FK_06b9bdc564bab6c33c92c4f7cc0\` FOREIGN KEY (\`user_material_calculation_template_id\`) REFERENCES \`user_material_calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_templates\` ADD CONSTRAINT \`FK_51c1a31afa659d89c3457010368\` FOREIGN KEY (\`created_by\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_material_calculation_templates\` ADD CONSTRAINT \`FK_08e6b8ce6b2e94be1e50bff48b6\` FOREIGN KEY (\`base_template_id\`) REFERENCES \`material_calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` ADD CONSTRAINT \`FK_14047a1c98dc98ce5b95d897110\` FOREIGN KEY (\`material_id\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` ADD CONSTRAINT \`FK_7a2b54d9d51d59f9a5ac3903145\` FOREIGN KEY (\`category_id\`) REFERENCES \`categories\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` ADD CONSTRAINT \`FK_e54cbc691fe8044c9f63eec86bb\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` ADD CONSTRAINT \`FK_cbb26d53c21e1dfb5de9b395ab6\` FOREIGN KEY (\`original_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` ADD CONSTRAINT \`FK_5a088977c3e95dbd185a356b4d0\` FOREIGN KEY (\`source_calculation_result_id\`) REFERENCES \`calculation_results\`(\`id\`) ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` ADD CONSTRAINT \`FK_dbe2c5d0c3b4f2b1668a1c0a6fb\` FOREIGN KEY (\`reviewed_by\`) REFERENCES \`users\`(\`id\`) ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`schedule_activity_templates\` ADD CONSTRAINT \`FK_41ddf61cb512dece28f283a8fdb\` FOREIGN KEY (\`scheduleTemplateId\`) REFERENCES \`schedule_templates\`(\`id\`) ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`schedule_templates\` ADD CONSTRAINT \`FK_cbf94afaf498cc4cc69cf99aa81\` FOREIGN KEY (\`created_by\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` ADD CONSTRAINT \`FK_9d9a16ba84129d20dd53ea77882\` FOREIGN KEY (\`reviewed_by\`) REFERENCES \`users\`(\`id\`) ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` ADD CONSTRAINT \`FK_a3785bcbb47694708263e0c33a8\` FOREIGN KEY (\`verified_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`professional_costs\` ADD CONSTRAINT \`FK_ba88269e180d9e3d670e2b920f8\` FOREIGN KEY (\`calculation_budget_id\`) REFERENCES \`calculation_budgets\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`professional_costs\` ADD CONSTRAINT \`FK_0fafa86df7d60b0a89be14a5c67\` FOREIGN KEY (\`professional_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`order_items\` ADD CONSTRAINT \`FK_a21e9d18e98c6f9f489a75027d4\` FOREIGN KEY (\`material_request_id\`) REFERENCES \`material_requests\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` ADD CONSTRAINT \`FK_a968dc1f591174a862e947a099a\` FOREIGN KEY (\`supplier_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`invoices\` ADD CONSTRAINT \`FK_9ba18dbe4ea525518c4b32df4b6\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`invoice_items\` ADD CONSTRAINT \`FK_7fb6895fc8fad9f5200e91abb59\` FOREIGN KEY (\`invoiceId\`) REFERENCES \`invoices\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`invoice_items\` ADD CONSTRAINT \`FK_f57d843bb46a121d4ebc9722bda\` FOREIGN KEY (\`materialId\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` ADD CONSTRAINT \`FK_85d7e3a9cb392c44061e730bf28\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` ADD CONSTRAINT \`FK_282e0117b2315610a378e7afc08\` FOREIGN KEY (\`trigger_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` ADD CONSTRAINT \`FK_6ed14207fe2755c8d2530824eeb\` FOREIGN KEY (\`calculation_result_id\`) REFERENCES \`calculation_results\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` ADD CONSTRAINT \`FK_51b6edc66f271d96867617f04a9\` FOREIGN KEY (\`applied_to_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` ADD CONSTRAINT \`FK_043809e28ff744481f88690fcc4\` FOREIGN KEY (\`improved_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` ADD CONSTRAINT \`FK_16b423eef8496fd15c5a550e726\` FOREIGN KEY (\`reviewed_by\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
    }

    public async down(queryRunner: QueryRunner): Promise<void> {
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` DROP FOREIGN KEY \`FK_16b423eef8496fd15c5a550e726\``);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` DROP FOREIGN KEY \`FK_043809e28ff744481f88690fcc4\``);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` DROP FOREIGN KEY \`FK_51b6edc66f271d96867617f04a9\``);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` DROP FOREIGN KEY \`FK_6ed14207fe2755c8d2530824eeb\``);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` DROP FOREIGN KEY \`FK_282e0117b2315610a378e7afc08\``);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` DROP FOREIGN KEY \`FK_85d7e3a9cb392c44061e730bf28\``);
        await queryRunner.query(`ALTER TABLE \`invoice_items\` DROP FOREIGN KEY \`FK_f57d843bb46a121d4ebc9722bda\``);
        await queryRunner.query(`ALTER TABLE \`invoice_items\` DROP FOREIGN KEY \`FK_7fb6895fc8fad9f5200e91abb59\``);
        await queryRunner.query(`ALTER TABLE \`invoices\` DROP FOREIGN KEY \`FK_9ba18dbe4ea525518c4b32df4b6\``);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` DROP FOREIGN KEY \`FK_a968dc1f591174a862e947a099a\``);
        await queryRunner.query(`ALTER TABLE \`order_items\` DROP FOREIGN KEY \`FK_a21e9d18e98c6f9f489a75027d4\``);
        await queryRunner.query(`ALTER TABLE \`professional_costs\` DROP FOREIGN KEY \`FK_0fafa86df7d60b0a89be14a5c67\``);
        await queryRunner.query(`ALTER TABLE \`professional_costs\` DROP FOREIGN KEY \`FK_ba88269e180d9e3d670e2b920f8\``);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` DROP FOREIGN KEY \`FK_a3785bcbb47694708263e0c33a8\``);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` DROP FOREIGN KEY \`FK_9d9a16ba84129d20dd53ea77882\``);
        await queryRunner.query(`ALTER TABLE \`schedule_templates\` DROP FOREIGN KEY \`FK_cbf94afaf498cc4cc69cf99aa81\``);
        await queryRunner.query(`ALTER TABLE \`schedule_activity_templates\` DROP FOREIGN KEY \`FK_41ddf61cb512dece28f283a8fdb\``);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` DROP FOREIGN KEY \`FK_dbe2c5d0c3b4f2b1668a1c0a6fb\``);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` DROP FOREIGN KEY \`FK_5a088977c3e95dbd185a356b4d0\``);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` DROP FOREIGN KEY \`FK_cbb26d53c21e1dfb5de9b395ab6\``);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` DROP FOREIGN KEY \`FK_e54cbc691fe8044c9f63eec86bb\``);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` DROP FOREIGN KEY \`FK_7a2b54d9d51d59f9a5ac3903145\``);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` DROP FOREIGN KEY \`FK_14047a1c98dc98ce5b95d897110\``);
        await queryRunner.query(`ALTER TABLE \`user_material_calculation_templates\` DROP FOREIGN KEY \`FK_08e6b8ce6b2e94be1e50bff48b6\``);
        await queryRunner.query(`ALTER TABLE \`material_calculation_templates\` DROP FOREIGN KEY \`FK_51c1a31afa659d89c3457010368\``);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` DROP FOREIGN KEY \`FK_06b9bdc564bab6c33c92c4f7cc0\``);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` DROP FOREIGN KEY \`FK_fc77d2e4b067b8d186a1e3a3806\``);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` DROP FOREIGN KEY \`FK_77a611a071acaa0cf60c3fcebc1\``);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` DROP FOREIGN KEY \`FK_b1efb9ee932ba7548dbab94754f\``);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` DROP FOREIGN KEY \`FK_7d269f828eae70d35bffc315669\``);
        await queryRunner.query(`ALTER TABLE \`user_template_usage\` DROP FOREIGN KEY \`FK_1040ea5eb6a7bc8f68f5aca6856\``);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` DROP FOREIGN KEY \`FK_50ed9ad3bb787a81b392954b64c\``);
        await queryRunner.query(`ALTER TABLE \`workforce\` DROP FOREIGN KEY \`FK_f05884dc0616f0771c08529b0a7\``);
        await queryRunner.query(`ALTER TABLE \`resource_assignments\` DROP FOREIGN KEY \`FK_b0a087f02461ad2dc118d3cf2b8\``);
        await queryRunner.query(`ALTER TABLE \`resource_assignments\` DROP FOREIGN KEY \`FK_010e78e3b02ee92d729928c2fc6\``);
        await queryRunner.query(`ALTER TABLE \`resource_assignments\` DROP FOREIGN KEY \`FK_cc91428297972daf501d7daab24\``);
        await queryRunner.query(`ALTER TABLE \`resource_assignments\` DROP FOREIGN KEY \`FK_979f24ea6e4b24cbbdee33dc376\``);
        await queryRunner.query(`ALTER TABLE \`equipment\` DROP FOREIGN KEY \`FK_8c675a8a1fb7097c17e3280d1df\``);
        await queryRunner.query(`ALTER TABLE \`schedule_activities\` DROP FOREIGN KEY \`FK_16031ba9d12734e1078b247f3f1\``);
        await queryRunner.query(`ALTER TABLE \`activity_progress\` DROP FOREIGN KEY \`FK_63f1159a898c208f25b7d172c4c\``);
        await queryRunner.query(`ALTER TABLE \`calculation_schedules\` DROP FOREIGN KEY \`FK_aebbbfc08784dfa941a708a1165\``);
        await queryRunner.query(`ALTER TABLE \`calculation_schedules\` DROP FOREIGN KEY \`FK_6a7202f312caac7ede7efcf3022\``);
        await queryRunner.query(`ALTER TABLE \`weather_factors\` DROP FOREIGN KEY \`FK_b9f38701cbc66f208f61b013124\``);
        await queryRunner.query(`ALTER TABLE \`progress_tracking\` DROP FOREIGN KEY \`FK_9db7e81bf10b079fc816dccb581\``);
        await queryRunner.query(`ALTER TABLE \`progress_tracking\` DROP FOREIGN KEY \`FK_338f163a05c4fbccaf8706fe91a\``);
        await queryRunner.query(`ALTER TABLE \`progress_tracking\` DROP FOREIGN KEY \`FK_2bfff54d7f1482535da8aca9feb\``);
        await queryRunner.query(`ALTER TABLE \`calculation_budgets\` DROP FOREIGN KEY \`FK_10e29d5e2eeef0638da230b8331\``);
        await queryRunner.query(`ALTER TABLE \`calculation_budgets\` DROP FOREIGN KEY \`FK_8ad93f7cb9c1cd3df35e27d313d\``);
        await queryRunner.query(`ALTER TABLE \`calculation_budgets\` DROP FOREIGN KEY \`FK_2e34c1bebebb6d8469b310852ba\``);
        await queryRunner.query(`ALTER TABLE \`calculation_budgets\` DROP FOREIGN KEY \`FK_c8eb229b61622c1ab6f8b7263b8\``);
        await queryRunner.query(`ALTER TABLE \`budget_line_items\` DROP FOREIGN KEY \`FK_a4a8e27d213c1e558564dab2381\``);
        await queryRunner.query(`ALTER TABLE \`budget_line_items\` DROP FOREIGN KEY \`FK_537e6164fe2a639937944cb091e\``);
        await queryRunner.query(`ALTER TABLE \`budget_templates\` DROP FOREIGN KEY \`FK_5050bf78898cb0b281db86a4c41\``);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` DROP FOREIGN KEY \`FK_853f129c2e18714b20ae9871d25\``);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` DROP FOREIGN KEY \`FK_c00f2503acc369fff5d14531c3d\``);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` DROP FOREIGN KEY \`FK_8dafddecd6032a3c7f93152c546\``);
        await queryRunner.query(`ALTER TABLE \`budget_items\` DROP FOREIGN KEY \`FK_ec3099cfe554eeff19bf6fbb952\``);
        await queryRunner.query(`ALTER TABLE \`phases\` DROP FOREIGN KEY \`FK_5cc8558954b6360a5b7fb5f45fa\``);
        await queryRunner.query(`ALTER TABLE \`tasks\` DROP FOREIGN KEY \`FK_9a16d2c86252529f622fa53f1e3\``);
        await queryRunner.query(`ALTER TABLE \`tasks\` DROP FOREIGN KEY \`FK_2687b3eaf84c102e4704b294d10\``);
        await queryRunner.query(`ALTER TABLE \`material_requests\` DROP FOREIGN KEY \`FK_7a37fb09c5fc8cb685d91ef7e77\``);
        await queryRunner.query(`ALTER TABLE \`material_requests\` DROP FOREIGN KEY \`FK_e31033962dc07b8d84a5b7ecb04\``);
        await queryRunner.query(`ALTER TABLE \`material_requests\` DROP FOREIGN KEY \`FK_0841476ce9e40a2604e4d68b022\``);
        await queryRunner.query(`ALTER TABLE \`categories\` DROP FOREIGN KEY \`FK_88cea2dc9c31951d06437879b40\``);
        await queryRunner.query(`ALTER TABLE \`users\` DROP FOREIGN KEY \`FK_4f0f50d9922a0ed51c214f5556b\``);
        await queryRunner.query(`DROP INDEX \`IDX_trending_calculations_period_rank\` ON \`trending_calculations\``);
        await queryRunner.query(`DROP INDEX \`IDX_user_templates_source\` ON \`user_calculation_templates\``);
        await queryRunner.query(`DROP INDEX \`IDX_usage_log_period\` ON \`user_template_usage_logs\``);
        await queryRunner.query(`ALTER TABLE \`accounting_transactions\` CHANGE \`error_message\` \`error_message\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`accounting_transactions\` DROP COLUMN \`metadata\``);
        await queryRunner.query(`ALTER TABLE \`accounting_transactions\` ADD \`metadata\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`accounting_transactions\` CHANGE \`accounting_system\` \`accounting_system\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`accounting_transactions\` CHANGE \`account_code\` \`account_code\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`accounting_transactions\` CHANGE \`external_id\` \`external_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`approval_notes\` \`approval_notes\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`approved_at\` \`approved_at\` timestamp NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`approved_by\` \`approved_by\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`recognition_level\` \`recognition_level\` enum ('bronze', 'silver', 'gold', 'platinum') NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`badge_earned\` \`badge_earned\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` DROP COLUMN \`metrics_at_promotion\``);
        await queryRunner.query(`ALTER TABLE \`author_credits\` ADD \`metrics_at_promotion\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`promotion_request_id\` \`promotion_request_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`promotion_date\` \`promotion_date\` timestamp NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`original_creation_date\` \`original_creation_date\` timestamp NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`contribution_percentage\` \`contribution_percentage\` decimal(5,2) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`contribution_description\` \`contribution_description\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` CHANGE \`custom_attribution\` \`custom_attribution\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_comparisons\` DROP COLUMN \`comparison_data\``);
        await queryRunner.query(`ALTER TABLE \`calculation_comparisons\` ADD \`comparison_data\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_comparisons\` CHANGE \`description\` \`description\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_guides\` CHANGE \`video_url\` \`video_url\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_guides\` CHANGE \`images\` \`images\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` DROP COLUMN \`dataAnalysis\``);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` ADD \`dataAnalysis\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` CHANGE \`feedback_ids\` \`feedback_ids\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` CHANGE \`reviewed_by\` \`reviewed_by\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` CHANGE \`improved_template_id\` \`improved_template_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` ADD CONSTRAINT \`FK_16b423eef8496fd15c5a550e726\` FOREIGN KEY (\`reviewed_by\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` ADD CONSTRAINT \`FK_043809e28ff744481f88690fcc4\` FOREIGN KEY (\`improved_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` CHANGE \`reviewed_by\` \`reviewed_by\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` CHANGE \`applied_to_template_id\` \`applied_to_template_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` DROP COLUMN \`suggestionDetails\``);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` ADD \`suggestionDetails\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` CHANGE \`comment\` \`comment\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` CHANGE \`rating\` \`rating\` decimal(3,2) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` CHANGE \`calculation_result_id\` \`calculation_result_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` ADD CONSTRAINT \`FK_51b6edc66f271d96867617f04a9\` FOREIGN KEY (\`applied_to_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` ADD CONSTRAINT \`FK_6ed14207fe2755c8d2530824eeb\` FOREIGN KEY (\`calculation_result_id\`) REFERENCES \`calculation_results\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` CHANGE \`clicked_at\` \`clicked_at\` datetime NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` CHANGE \`trigger_template_id\` \`trigger_template_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` CHANGE \`project_id\` \`project_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` ADD CONSTRAINT \`FK_282e0117b2315610a378e7afc08\` FOREIGN KEY (\`trigger_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` ADD CONSTRAINT \`FK_85d7e3a9cb392c44061e730bf28\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` CHANGE \`nec_reference\` \`nec_reference\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` DROP COLUMN \`location_coordinates\``);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` ADD \`location_coordinates\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` CHANGE \`snow_load\` \`snow_load\` decimal(5,2) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` CHANGE \`rainfall_intensity\` \`rainfall_intensity\` decimal(5,2) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` CHANGE \`wind_speed\` \`wind_speed\` decimal(5,2) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` CHANGE \`climate_zone\` \`climate_zone\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` CHANGE \`elevation\` \`elevation\` int NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` CHANGE \`default_soil_type\` \`default_soil_type\` enum ('type_a', 'type_b', 'type_c', 'type_d', 'type_e', 'type_f') NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` CHANGE \`parent_zone_id\` \`parent_zone_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`geographical_zones\` CHANGE \`description\` \`description\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`invoice_items\` CHANGE \`materialId\` \`materialId\` varchar(36) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`invoice_items\` CHANGE \`invoiceId\` \`invoiceId\` varchar(36) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`invoice_items\` CHANGE \`material_id\` \`material_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`invoice_items\` ADD CONSTRAINT \`FK_f57d843bb46a121d4ebc9722bda\` FOREIGN KEY (\`materialId\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`invoice_items\` ADD CONSTRAINT \`FK_7fb6895fc8fad9f5200e91abb59\` FOREIGN KEY (\`invoiceId\`) REFERENCES \`invoices\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`invoices\` CHANGE \`deleted_at\` \`deleted_at\` datetime(6) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`invoices\` CHANGE \`project_id\` \`project_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`invoices\` CHANGE \`notes\` \`notes\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`invoices\` CHANGE \`electronic_invoice_url\` \`electronic_invoice_url\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`invoices\` CHANGE \`sri_access_key\` \`sri_access_key\` varchar(255) NULL COMMENT 'Clave de acceso SRI (para facturación electrónica)' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`invoices\` CHANGE \`sri_authorization\` \`sri_authorization\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`invoices\` CHANGE \`payment_date\` \`payment_date\` date NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`invoices\` CHANGE \`payment_reference\` \`payment_reference\` varchar(255) NULL COMMENT 'Número de transacción, cheque, etc.' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`invoices\` CHANGE \`payment_method\` \`payment_method\` enum ('cash', 'bank_transfer', 'credit_card', 'debit_card', 'check', 'paypal', 'other') NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`invoices\` ADD CONSTRAINT \`FK_9ba18dbe4ea525518c4b32df4b6\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` CHANGE \`price_change_percentage\` \`price_change_percentage\` decimal(5,2) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` CHANGE \`supplier_id\` \`supplier_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` CHANGE \`supplier_name\` \`supplier_name\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` CHANGE \`notes\` \`notes\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` CHANGE \`reason\` \`reason\` enum ('supplier_update', 'market_fluctuation', 'promotion', 'seasonal_change', 'inflation_adjustment', 'bulk_discount', 'other') NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` CHANGE \`end_date\` \`end_date\` date NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` CHANGE \`wholesale_min_quantity\` \`wholesale_min_quantity\` int NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` CHANGE \`wholesale_price\` \`wholesale_price\` decimal(10,2) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` ADD CONSTRAINT \`FK_a968dc1f591174a862e947a099a\` FOREIGN KEY (\`supplier_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_property_values\` DROP COLUMN \`json_value\``);
        await queryRunner.query(`ALTER TABLE \`material_property_values\` ADD \`json_value\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_property_values\` CHANGE \`array_value\` \`array_value\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_property_values\` CHANGE \`date_value\` \`date_value\` datetime NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_property_values\` CHANGE \`boolean_value\` \`boolean_value\` tinyint NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_property_values\` CHANGE \`number_value\` \`number_value\` decimal(18,6) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_property_values\` CHANGE \`text_value\` \`text_value\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_property_definitions\` DROP COLUMN \`options\``);
        await queryRunner.query(`ALTER TABLE \`material_property_definitions\` ADD \`options\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_property_definitions\` CHANGE \`description\` \`description\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_template_usage_logs\` CHANGE \`user_agent\` \`user_agent\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_template_usage_logs\` CHANGE \`ip_address\` \`ip_address\` varchar(45) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_template_usage_logs\` CHANGE \`total_cost\` \`total_cost\` decimal(12,2) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_template_usage_logs\` CHANGE \`project_id\` \`project_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_results\` CHANGE \`notes\` \`notes\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_results\` CHANGE \`currency\` \`currency\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_results\` CHANGE \`total_cost\` \`total_cost\` decimal(12,2) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_results\` CHANGE \`project_id\` \`project_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`notifications\` CHANGE \`icon\` \`icon\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`notifications\` CHANGE \`expires_at\` \`expires_at\` datetime NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`notifications\` CHANGE \`related_entity_id\` \`related_entity_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`notifications\` CHANGE \`related_entity_type\` \`related_entity_type\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`notifications\` CHANGE \`action_text\` \`action_text\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`notifications\` CHANGE \`action_url\` \`action_url\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`notifications\` CHANGE \`read_at\` \`read_at\` datetime NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`notifications\` CHANGE \`type\` \`type\` enum ('price_change', 'project_delay', 'material_request', 'task_assignment', 'document_upload', 'payment_due', 'inventory_low', 'calculation_complete', 'system_announcement', 'budget_approval', 'price_update', 'material_import', 'info', 'warning', 'error', 'success', 'system') NOT NULL`);
        await queryRunner.query(`ALTER TABLE \`order_items\` CHANGE \`notes\` \`notes\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`order_items\` CHANGE \`material_request_id\` \`material_request_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`order_items\` ADD CONSTRAINT \`FK_a21e9d18e98c6f9f489a75027d4\` FOREIGN KEY (\`material_request_id\`) REFERENCES \`material_requests\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`orders\` DROP COLUMN \`tracking_info\``);
        await queryRunner.query(`ALTER TABLE \`orders\` ADD \`tracking_info\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`orders\` CHANGE \`actual_delivery_date\` \`actual_delivery_date\` date NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`orders\` CHANGE \`estimated_delivery_date\` \`estimated_delivery_date\` date NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`orders\` CHANGE \`notes\` \`notes\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` CHANGE \`quality_score\` \`quality_score\` decimal(3,2) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` CHANGE \`implementation_notes\` \`implementation_notes\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` DROP COLUMN \`approval_workflow\``);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` ADD \`approval_workflow\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` DROP COLUMN \`estimated_impact\``);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` ADD \`estimated_impact\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` CHANGE \`verified_template_id\` \`verified_template_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` CHANGE \`review_comments\` \`review_comments\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` CHANGE \`reviewed_at\` \`reviewed_at\` timestamp NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` CHANGE \`reviewed_by\` \`reviewed_by\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` CHANGE \`detailed_justification\` \`detailed_justification\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` ADD CONSTRAINT \`FK_a3785bcbb47694708263e0c33a8\` FOREIGN KEY (\`verified_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` ADD CONSTRAINT \`FK_9d9a16ba84129d20dd53ea77882\` FOREIGN KEY (\`reviewed_by\`) REFERENCES \`users\`(\`id\`) ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`template_ratings\` CHANGE \`comment\` \`comment\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` CHANGE \`reviewed_at\` \`reviewed_at\` datetime NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` CHANGE \`reviewed_by\` \`reviewed_by\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` DROP COLUMN \`references\``);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` ADD \`references\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` CHANGE \`justification\` \`justification\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` CHANGE \`proposed_value\` \`proposed_value\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` CHANGE \`current_value\` \`current_value\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` ADD CONSTRAINT \`FK_dbe2c5d0c3b4f2b1668a1c0a6fb\` FOREIGN KEY (\`reviewed_by\`) REFERENCES \`users\`(\`id\`) ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`trending_calculations\` CHANGE \`rank_position\` \`rank_position\` int NULL DEFAULT 'NULL'`);
        await queryRunner.query(`CREATE INDEX \`IDX_trending_calculations_period_rank\` ON \`trending_calculations\` (\`period\`, \`rank_position\`)`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` DROP COLUMN \`contributors\``);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` ADD \`contributors\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` DROP COLUMN \`shared_with\``);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` ADD \`shared_with\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` DROP COLUMN \`limitations\``);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` ADD \`limitations\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` DROP COLUMN \`application_cases\``);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` ADD \`application_cases\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` DROP COLUMN \`requirements\``);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` ADD \`requirements\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` DROP COLUMN \`tags\``);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` ADD \`tags\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` CHANGE \`nec_reference\` \`nec_reference\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` CHANGE \`estimated_time\` \`estimated_time\` varchar(50) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` CHANGE \`subcategory\` \`subcategory\` varchar(50) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` CHANGE \`source_calculation_result_id\` \`source_calculation_result_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` CHANGE \`original_template_id\` \`original_template_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` CHANGE \`long_description\` \`long_description\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`CREATE INDEX \`IDX_user_templates_source\` ON \`user_calculation_templates\` (\`source_type\`, \`original_template_id\`)`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` ADD CONSTRAINT \`FK_5a088977c3e95dbd185a356b4d0\` FOREIGN KEY (\`source_calculation_result_id\`) REFERENCES \`calculation_results\`(\`id\`) ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` ADD CONSTRAINT \`FK_cbb26d53c21e1dfb5de9b395ab6\` FOREIGN KEY (\`original_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` CHANGE \`user_agent\` \`user_agent\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` CHANGE \`ip_address\` \`ip_address\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` CHANGE \`session_id\` \`session_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` DROP COLUMN \`metadata\``);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` ADD \`metadata\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` CHANGE \`search_query\` \`search_query\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` CHANGE \`project_id\` \`project_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` CHANGE \`category_id\` \`category_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` CHANGE \`material_id\` \`material_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` ADD CONSTRAINT \`FK_e54cbc691fe8044c9f63eec86bb\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` ADD CONSTRAINT \`FK_7a2b54d9d51d59f9a5ac3903145\` FOREIGN KEY (\`category_id\`) REFERENCES \`categories\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` ADD CONSTRAINT \`FK_14047a1c98dc98ce5b95d897110\` FOREIGN KEY (\`material_id\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_material_calculation_templates\` CHANGE \`tags\` \`tags\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_material_calculation_templates\` CHANGE \`base_template_id\` \`base_template_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_material_calculation_templates\` ADD CONSTRAINT \`FK_08e6b8ce6b2e94be1e50bff48b6\` FOREIGN KEY (\`base_template_id\`) REFERENCES \`material_calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_templates\` CHANGE \`tags\` \`tags\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_templates\` CHANGE \`created_by\` \`created_by\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_templates\` CHANGE \`normative_reference\` \`normative_reference\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_templates\` DROP COLUMN \`regionalFactors\``);
        await queryRunner.query(`ALTER TABLE \`material_calculation_templates\` ADD \`regionalFactors\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_templates\` ADD CONSTRAINT \`FK_51c1a31afa659d89c3457010368\` FOREIGN KEY (\`created_by\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` CHANGE \`user_material_calculation_template_id\` \`user_material_calculation_template_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` CHANGE \`material_calculation_template_id\` \`material_calculation_template_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` CHANGE \`depends_on_parameters\` \`depends_on_parameters\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` CHANGE \`help_text\` \`help_text\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` CHANGE \`allowedValues\` \`allowedValues\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` CHANGE \`unit\` \`unit\` enum ('m2', 'm3', 'ml', 'units', 'kg', 'bags', 'sheets') NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` CHANGE \`max_value\` \`max_value\` float(12) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` CHANGE \`min_value\` \`min_value\` float(12) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` CHANGE \`default_value\` \`default_value\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` ADD CONSTRAINT \`FK_06b9bdc564bab6c33c92c4f7cc0\` FOREIGN KEY (\`user_material_calculation_template_id\`) REFERENCES \`user_material_calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` ADD CONSTRAINT \`FK_fc77d2e4b067b8d186a1e3a3806\` FOREIGN KEY (\`material_calculation_template_id\`) REFERENCES \`material_calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` CHANGE \`expires_at\` \`expires_at\` datetime NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` CHANGE \`reason\` \`reason\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` CHANGE \`supplier_id\` \`supplier_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` CHANGE \`project_type\` \`project_type\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` CHANGE \`category_id\` \`category_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` CHANGE \`material_id\` \`material_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` ADD CONSTRAINT \`FK_77a611a071acaa0cf60c3fcebc1\` FOREIGN KEY (\`supplier_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` ADD CONSTRAINT \`FK_b1efb9ee932ba7548dbab94754f\` FOREIGN KEY (\`category_id\`) REFERENCES \`categories\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` ADD CONSTRAINT \`FK_7d269f828eae70d35bffc315669\` FOREIGN KEY (\`material_id\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage\` CHANGE \`user_rating\` \`user_rating\` decimal(3,2) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage\` CHANGE \`average_calculation_time_ms\` \`average_calculation_time_ms\` int NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage\` CHANGE \`average_completion_time_ms\` \`average_completion_time_ms\` int NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage\` CHANGE \`project_id\` \`project_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage\` ADD CONSTRAINT \`FK_1040ea5eb6a7bc8f68f5aca6856\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` CHANGE \`error_message\` \`error_message\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` DROP COLUMN \`output_results\``);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` ADD \`output_results\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` DROP COLUMN \`input_parameters\``);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` ADD \`input_parameters\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` CHANGE \`user_agent\` \`user_agent\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` CHANGE \`ip_address\` \`ip_address\` varchar(45) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` CHANGE \`usage_date\` \`usage_date\` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP()`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` CHANGE \`project_id\` \`project_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`CREATE INDEX \`IDX_usage_log_period\` ON \`user_template_usage_logs\` (\`template_id\`, \`template_type\`, \`usage_date\`)`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` ADD CONSTRAINT \`FK_50ed9ad3bb787a81b392954b64c\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` CHANGE \`error_message\` \`error_message\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` CHANGE \`execution_time_ms\` \`execution_time_ms\` int NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` CHANGE \`notes\` \`notes\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` CHANGE \`name\` \`name\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` CHANGE \`project_id\` \`project_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` ADD CONSTRAINT \`FK_853f129c2e18714b20ae9871d25\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` DROP COLUMN \`tags\``);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` ADD \`tags\` longtext COLLATE "utf8mb4_bin" NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` CHANGE \`verified_at\` \`verified_at\` datetime NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` CHANGE \`verified_by\` \`verified_by\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` CHANGE \`created_by\` \`created_by\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` CHANGE \`parent_template_id\` \`parent_template_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` CHANGE \`nec_reference\` \`nec_reference\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` ADD CONSTRAINT \`FK_c00f2503acc369fff5d14531c3d\` FOREIGN KEY (\`created_by\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` ADD CONSTRAINT \`FK_8dafddecd6032a3c7f93152c546\` FOREIGN KEY (\`parent_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` CHANGE \`formula\` \`formula\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` CHANGE \`depends_on_parameters\` \`depends_on_parameters\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` CHANGE \`help_text\` \`help_text\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` CHANGE \`allowed_values\` \`allowed_values\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` CHANGE \`unit_of_measure\` \`unit_of_measure\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` CHANGE \`regex_pattern\` \`regex_pattern\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` CHANGE \`max_value\` \`max_value\` float(12) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` CHANGE \`min_value\` \`min_value\` float(12) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` CHANGE \`default_value\` \`default_value\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`deleted_at\` \`deleted_at\` datetime(6) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`currentCost\` \`currentCost\` decimal(12,2) NULL COMMENT 'Costo total actual' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`estimatedBudget\` \`estimatedBudget\` decimal(12,2) NULL COMMENT 'Presupuesto total estimado' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`projects\` DROP COLUMN \`tags\``);
        await queryRunner.query(`ALTER TABLE \`projects\` ADD \`tags\` longtext COLLATE "utf8mb4_bin" NULL COMMENT 'Etiquetas para categorización' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`projects\` DROP COLUMN \`permits\``);
        await queryRunner.query(`ALTER TABLE \`projects\` ADD \`permits\` longtext COLLATE "utf8mb4_bin" NULL COMMENT 'Permisos y licencias' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`projects\` DROP COLUMN \`location\``);
        await queryRunner.query(`ALTER TABLE \`projects\` ADD \`location\` longtext COLLATE "utf8mb4_bin" NULL COMMENT 'Coordenadas de ubicación' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`floors\` \`floors\` int NULL COMMENT 'Número de pisos' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`construction_area\` \`construction_area\` decimal(10,2) NULL COMMENT 'Área de construcción en metros cuadrados' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`total_area\` \`total_area\` decimal(10,2) NULL COMMENT 'Área total en metros cuadrados' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`estimated_completion_date\` \`estimated_completion_date\` date NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`end_date\` \`end_date\` date NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`client_phone\` \`client_phone\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`client_email\` \`client_email\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`client_name\` \`client_name\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`type\` \`type\` enum ('residential', 'commercial', 'industrial', 'infrastructure', 'remodeling', 'maintenance', 'other') NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`projects\` CHANGE \`description\` \`description\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`project_team_members\` CHANGE \`end_date\` \`end_date\` date NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`project_team_members\` CHANGE \`start_date\` \`start_date\` date NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`project_team_members\` CHANGE \`allocated_hours\` \`allocated_hours\` int NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`project_team_members\` CHANGE \`hourly_rate\` \`hourly_rate\` decimal(10,2) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`project_team_members\` CHANGE \`responsibilities\` \`responsibilities\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`project_budgets\` CHANGE \`description\` \`description\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`budget_items\` CHANGE \`material_id\` \`material_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`budget_items\` CHANGE \`category\` \`category\` varchar(255) NULL COMMENT 'Categoría del ítem (materiales, mano de obra, etc.)' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`budget_items\` ADD CONSTRAINT \`FK_ec3099cfe554eeff19bf6fbb952\` FOREIGN KEY (\`material_id\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`project_documents\` CHANGE \`description\` \`description\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`phases\` CHANGE \`projectId\` \`projectId\` varchar(36) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`phases\` CHANGE \`deleted_at\` \`deleted_at\` datetime(6) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`phases\` CHANGE \`end_date\` \`end_date\` date NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`phases\` CHANGE \`description\` \`description\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`phases\` ADD CONSTRAINT \`FK_5cc8558954b6360a5b7fb5f45fa\` FOREIGN KEY (\`projectId\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`tasks\` CHANGE \`assigneeId\` \`assigneeId\` varchar(36) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`tasks\` CHANGE \`phaseId\` \`phaseId\` varchar(36) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`tasks\` CHANGE \`deleted_at\` \`deleted_at\` datetime(6) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`tasks\` CHANGE \`assigned_to\` \`assigned_to\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`tasks\` CHANGE \`end_date\` \`end_date\` date NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`tasks\` CHANGE \`start_date\` \`start_date\` date NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`tasks\` CHANGE \`description\` \`description\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`tasks\` ADD CONSTRAINT \`FK_9a16d2c86252529f622fa53f1e3\` FOREIGN KEY (\`assigneeId\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`tasks\` ADD CONSTRAINT \`FK_2687b3eaf84c102e4704b294d10\` FOREIGN KEY (\`phaseId\`) REFERENCES \`phases\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_requests\` CHANGE \`requesterId\` \`requesterId\` varchar(36) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_requests\` CHANGE \`materialId\` \`materialId\` varchar(36) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_requests\` CHANGE \`taskId\` \`taskId\` varchar(36) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_requests\` CHANGE \`deleted_at\` \`deleted_at\` datetime(6) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_requests\` CHANGE \`notes\` \`notes\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`material_requests\` ADD CONSTRAINT \`FK_7a37fb09c5fc8cb685d91ef7e77\` FOREIGN KEY (\`requesterId\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_requests\` ADD CONSTRAINT \`FK_e31033962dc07b8d84a5b7ecb04\` FOREIGN KEY (\`materialId\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_requests\` ADD CONSTRAINT \`FK_0841476ce9e40a2604e4d68b022\` FOREIGN KEY (\`taskId\`) REFERENCES \`tasks\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`deleted_at\` \`deleted_at\` datetime(6) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`tags\` \`tags\` text NULL COMMENT 'Etiquetas para búsqueda y categorización' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`materials\` DROP COLUMN \`dimensions\``);
        await queryRunner.query(`ALTER TABLE \`materials\` ADD \`dimensions\` longtext COLLATE "utf8mb4_bin" NULL COMMENT 'Dimensiones (largo, ancho, alto, peso)' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`image_urls\` \`image_urls\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`barcode\` \`barcode\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`sku\` \`sku\` varchar(255) NULL COMMENT 'Código único de producto' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`model\` \`model\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`brand\` \`brand\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`wholesale_min_quantity\` \`wholesale_min_quantity\` int NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`wholesale_price\` \`wholesale_price\` decimal(10,2) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`specifications\` \`specifications\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`materials\` CHANGE \`description\` \`description\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`categories\` CHANGE \`deleted_at\` \`deleted_at\` datetime(6) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`categories\` CHANGE \`parent_id\` \`parent_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`categories\` CHANGE \`image_url\` \`image_url\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`categories\` CHANGE \`icon\` \`icon\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`categories\` CHANGE \`description\` \`description\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`categories\` ADD CONSTRAINT \`FK_88cea2dc9c31951d06437879b40\` FOREIGN KEY (\`parent_id\`) REFERENCES \`categories\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`deleted_at\` \`deleted_at\` datetime(6) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`location\` \`location\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`recovery_codes\` \`recovery_codes\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`two_factor_secret\` \`two_factor_secret\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`admin_id\` \`admin_id\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`password_reset_expires\` \`password_reset_expires\` datetime NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`password_reset_token\` \`password_reset_token\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`verification_token\` \`verification_token\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` DROP COLUMN \`socialLinks\``);
        await queryRunner.query(`ALTER TABLE \`users\` ADD \`socialLinks\` longtext COLLATE "utf8mb4_bin" NULL COMMENT 'Links a redes sociales' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`referred_by\` \`referred_by\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`referral_code\` \`referral_code\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`interests\` \`interests\` text NULL COMMENT 'Intereses del usuario para recomendaciones' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` DROP COLUMN \`stats\``);
        await queryRunner.query(`ALTER TABLE \`users\` ADD \`stats\` longtext COLLATE "utf8mb4_bin" NULL COMMENT 'Estadísticas del usuario' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` DROP COLUMN \`preferences\``);
        await queryRunner.query(`ALTER TABLE \`users\` ADD \`preferences\` longtext COLLATE "utf8mb4_bin" NULL COMMENT 'Preferencias del usuario' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` DROP COLUMN \`company\``);
        await queryRunner.query(`ALTER TABLE \`users\` ADD \`company\` longtext COLLATE "utf8mb4_bin" NULL COMMENT 'Información de la empresa del usuario' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`subscription_expires_at\` \`subscription_expires_at\` datetime NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`bio\` \`bio\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`certifications\` \`certifications\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`education_level\` \`education_level\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`years_of_experience\` \`years_of_experience\` int NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`specializations\` \`specializations\` text NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`professional_type\` \`professional_type\` enum ('architect', 'civil_engineer', 'constructor', 'contractor', 'electrician', 'plumber', 'designer', 'other') NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`profile_picture\` \`profile_picture\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`gender\` \`gender\` enum ('male', 'female', 'other', 'prefer_not_to_say') NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`national_id\` \`national_id\` varchar(255) NULL COMMENT 'Cédula o RUC' DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`date_of_birth\` \`date_of_birth\` date NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`mobile_phone\` \`mobile_phone\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` CHANGE \`phone\` \`phone\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`users\` ADD CONSTRAINT \`FK_4f0f50d9922a0ed51c214f5556b\` FOREIGN KEY (\`admin_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_addresses\` CHANGE \`reference\` \`reference\` varchar(255) NULL DEFAULT 'NULL'`);
        await queryRunner.query(`ALTER TABLE \`materials\` DROP COLUMN \`supplierInfo\``);
        await queryRunner.query(`ALTER TABLE \`materials\` DROP COLUMN \`type\``);
        await queryRunner.query(`ALTER TABLE \`materials\` DROP COLUMN \`last_inventory_update\``);
        await queryRunner.query(`ALTER TABLE \`materials\` DROP COLUMN \`last_price_update\``);
        await queryRunner.query(`ALTER TABLE \`materials\` DROP COLUMN \`supplier_code\``);
        await queryRunner.query(`ALTER TABLE \`materials\` DROP COLUMN \`external_id\``);
        await queryRunner.query(`ALTER TABLE \`materials\` DROP COLUMN \`available_quantity\``);
        await queryRunner.query(`ALTER TABLE \`materials\` DROP COLUMN \`unitCost\``);
        await queryRunner.query(`ALTER TABLE \`materials\` DROP COLUMN \`currentPrice\``);
        await queryRunner.query(`DROP INDEX \`IDX_prof_cost_budget\` ON \`professional_costs\``);
        await queryRunner.query(`DROP INDEX \`IDX_prof_cost_service\` ON \`professional_costs\``);
        await queryRunner.query(`DROP TABLE \`professional_costs\``);
        await queryRunner.query(`DROP INDEX \`IDX_cdfd67d0daa352b589e1be4e1b\` ON \`schedule_templates\``);
        await queryRunner.query(`DROP INDEX \`IDX_e080cf9ea4488f0230191c6029\` ON \`schedule_templates\``);
        await queryRunner.query(`DROP INDEX \`IDX_1dc4122e4da8eb4b1ce266d61e\` ON \`schedule_templates\``);
        await queryRunner.query(`DROP TABLE \`schedule_templates\``);
        await queryRunner.query(`DROP TABLE \`schedule_activity_templates\``);
        await queryRunner.query(`DROP TABLE \`workforce\``);
        await queryRunner.query(`DROP INDEX \`IDX_d63157cb19c566c4ebc64cc06e\` ON \`resource_assignments\``);
        await queryRunner.query(`DROP INDEX \`IDX_0f84147f30821bcd93268413c8\` ON \`resource_assignments\``);
        await queryRunner.query(`DROP INDEX \`IDX_fad1d33d835ba554471f2f873e\` ON \`resource_assignments\``);
        await queryRunner.query(`DROP TABLE \`resource_assignments\``);
        await queryRunner.query(`DROP TABLE \`equipment\``);
        await queryRunner.query(`DROP INDEX \`IDX_2a02c90148b37b5d0b3b883718\` ON \`schedule_activities\``);
        await queryRunner.query(`DROP INDEX \`IDX_9d846bf99b24094bd3a7db67ef\` ON \`schedule_activities\``);
        await queryRunner.query(`DROP INDEX \`IDX_7dc6c5a72586d87ba01760adff\` ON \`schedule_activities\``);
        await queryRunner.query(`DROP TABLE \`schedule_activities\``);
        await queryRunner.query(`DROP INDEX \`IDX_2c78487cbf6f9d89f6a2d5115f\` ON \`activity_progress\``);
        await queryRunner.query(`DROP INDEX \`IDX_da33e9e80ac0e767ad6da3890e\` ON \`activity_progress\``);
        await queryRunner.query(`DROP INDEX \`IDX_61cb7e9895596e65a5121ef095\` ON \`activity_progress\``);
        await queryRunner.query(`DROP TABLE \`activity_progress\``);
        await queryRunner.query(`DROP TABLE \`calculation_schedules\``);
        await queryRunner.query(`DROP INDEX \`IDX_a1c0e4a1753372ec5ab332f017\` ON \`weather_factors\``);
        await queryRunner.query(`DROP INDEX \`IDX_67b15f614b28d1cd69b0fceeea\` ON \`weather_factors\``);
        await queryRunner.query(`DROP TABLE \`weather_factors\``);
        await queryRunner.query(`DROP INDEX \`IDX_aef90bb2c16f49e15e863f3149\` ON \`progress_tracking\``);
        await queryRunner.query(`DROP INDEX \`IDX_cfa565542f299054bf8c4b7dfe\` ON \`progress_tracking\``);
        await queryRunner.query(`DROP TABLE \`progress_tracking\``);
        await queryRunner.query(`DROP INDEX \`IDX_calc_budget_project_status\` ON \`calculation_budgets\``);
        await queryRunner.query(`DROP INDEX \`IDX_calc_budget_template\` ON \`calculation_budgets\``);
        await queryRunner.query(`DROP INDEX \`IDX_calc_budget_user_created\` ON \`calculation_budgets\``);
        await queryRunner.query(`DROP TABLE \`calculation_budgets\``);
        await queryRunner.query(`DROP INDEX \`IDX_budget_line_item_budget\` ON \`budget_line_items\``);
        await queryRunner.query(`DROP INDEX \`IDX_budget_line_item_material\` ON \`budget_line_items\``);
        await queryRunner.query(`DROP INDEX \`IDX_budget_line_item_type_source\` ON \`budget_line_items\``);
        await queryRunner.query(`DROP TABLE \`budget_line_items\``);
        await queryRunner.query(`DROP INDEX \`idx_budget_template_project_type\` ON \`budget_templates\``);
        await queryRunner.query(`DROP INDEX \`idx_budget_template_geographical_zone\` ON \`budget_templates\``);
        await queryRunner.query(`DROP INDEX \`idx_budget_template_scope\` ON \`budget_templates\``);
        await queryRunner.query(`DROP INDEX \`idx_budget_template_active\` ON \`budget_templates\``);
        await queryRunner.query(`DROP INDEX \`idx_budget_template_verified\` ON \`budget_templates\``);
        await queryRunner.query(`DROP INDEX \`idx_budget_template_created_by\` ON \`budget_templates\``);
        await queryRunner.query(`DROP TABLE \`budget_templates\``);
    }

}
