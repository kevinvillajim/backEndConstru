import { MigrationInterface, QueryRunner } from "typeorm";

export class InitialSchema1749620889533 implements MigrationInterface {
    name = 'InitialSchema1749620889533'

    public async up(queryRunner: QueryRunner): Promise<void> {
        await queryRunner.query(`CREATE TABLE \`user_addresses\` (\`id\` varchar(36) NOT NULL, \`user_id\` varchar(255) NOT NULL, \`street\` varchar(255) NOT NULL, \`number\` varchar(255) NOT NULL, \`city\` varchar(255) NOT NULL, \`province\` varchar(255) NOT NULL, \`postalCode\` varchar(255) NOT NULL, \`country\` varchar(255) NOT NULL, \`reference\` varchar(255) NULL, \`is_main\` tinyint NOT NULL DEFAULT 0, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`users\` (\`id\` varchar(36) NOT NULL, \`first_name\` varchar(255) NOT NULL, \`last_name\` varchar(255) NOT NULL, \`email\` varchar(255) NOT NULL, \`password\` varchar(255) NOT NULL, \`phone\` varchar(255) NULL, \`mobile_phone\` varchar(255) NULL, \`date_of_birth\` date NULL, \`national_id\` varchar(255) NULL COMMENT 'Cédula o RUC', \`gender\` enum ('male', 'female', 'other', 'prefer_not_to_say') NULL, \`profile_picture\` varchar(255) NULL, \`professional_type\` enum ('architect', 'civil_engineer', 'constructor', 'contractor', 'electrician', 'plumber', 'designer', 'other') NULL, \`specializations\` text NULL, \`years_of_experience\` int NULL, \`education_level\` varchar(255) NULL, \`certifications\` text NULL, \`bio\` text NULL, \`role\` enum ('admin', 'normal', 'seller', 'worker') NOT NULL DEFAULT 'normal', \`subscription_plan\` enum ('free', 'premium', 'enterprise', 'custom') NOT NULL DEFAULT 'free', \`subscription_expires_at\` datetime NULL, \`company\` json NULL COMMENT 'Información de la empresa del usuario', \`preferences\` json NULL COMMENT 'Preferencias del usuario', \`stats\` json NULL COMMENT 'Estadísticas del usuario', \`interests\` text NULL COMMENT 'Intereses del usuario para recomendaciones', \`referral_code\` varchar(255) NULL, \`referred_by\` varchar(255) NULL, \`socialLinks\` json NULL COMMENT 'Links a redes sociales', \`is_active\` tinyint NOT NULL DEFAULT 1, \`is_verified\` tinyint NOT NULL DEFAULT 0, \`verification_token\` varchar(255) NULL, \`password_reset_token\` varchar(255) NULL, \`password_reset_expires\` datetime NULL, \`admin_id\` varchar(255) NULL, \`two_factor_enabled\` tinyint NOT NULL DEFAULT 0, \`two_factor_secret\` varchar(255) NULL, \`recovery_codes\` text NULL, \`location\` varchar(255) NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), \`deleted_at\` datetime(6) NULL, INDEX \`IDX_users_subscription_plan\` (\`subscription_plan\`), UNIQUE INDEX \`IDX_97672ac88f789774dd47f7c8be\` (\`email\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`categories\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NULL, \`icon\` varchar(255) NULL, \`image_url\` varchar(255) NULL, \`is_active\` tinyint NOT NULL DEFAULT 1, \`parent_id\` varchar(255) NULL, \`display_order\` int NOT NULL DEFAULT '0', \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), \`deleted_at\` datetime(6) NULL, PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`materials\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NULL, \`specifications\` text NULL, \`price\` decimal(10,2) NOT NULL, \`wholesale_price\` decimal(10,2) NULL, \`wholesale_min_quantity\` int NULL, \`stock\` int NOT NULL DEFAULT '0', \`min_stock\` int NOT NULL COMMENT 'Stock mínimo para alertas' DEFAULT '0', \`unit_of_measure\` varchar(255) NOT NULL, \`brand\` varchar(255) NULL, \`model\` varchar(255) NULL, \`sku\` varchar(255) NULL COMMENT 'Código único de producto', \`barcode\` varchar(255) NULL, \`image_urls\` text NULL, \`is_featured\` tinyint NOT NULL DEFAULT 0, \`is_active\` tinyint NOT NULL DEFAULT 1, \`dimensions\` json NULL COMMENT 'Dimensiones (largo, ancho, alto, peso)', \`category_id\` varchar(255) NOT NULL, \`seller_id\` varchar(255) NOT NULL, \`tags\` text NULL COMMENT 'Etiquetas para búsqueda y categorización', \`rating\` decimal(3,2) NOT NULL COMMENT 'Calificación promedio (0-5)' DEFAULT '0.00', \`rating_count\` int NOT NULL DEFAULT '0', \`view_count\` int NOT NULL DEFAULT '0', \`order_count\` int NOT NULL DEFAULT '0', \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), \`deleted_at\` datetime(6) NULL, UNIQUE INDEX \`IDX_2c638e9b0ddf9b957accdaa911\` (\`sku\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`material_requests\` (\`id\` varchar(36) NOT NULL, \`quantity\` int NOT NULL, \`status\` enum ('pending', 'approved', 'delivered', 'rejected') NOT NULL DEFAULT 'pending', \`task_id\` varchar(255) NOT NULL, \`material_id\` varchar(255) NOT NULL, \`requester_id\` varchar(255) NOT NULL, \`notes\` varchar(255) NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), \`deleted_at\` datetime(6) NULL, \`taskId\` varchar(36) NULL, \`materialId\` varchar(36) NULL, \`requesterId\` varchar(36) NULL, PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`tasks\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NULL, \`status\` enum ('pending', 'in_progress', 'completed', 'blocked') NOT NULL DEFAULT 'pending', \`start_date\` date NULL, \`end_date\` date NULL, \`phase_id\` varchar(255) NOT NULL, \`assigned_to\` varchar(255) NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), \`deleted_at\` datetime(6) NULL, \`phaseId\` varchar(36) NULL, \`assigneeId\` varchar(36) NULL, PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`phases\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NULL, \`start_date\` date NOT NULL, \`end_date\` date NULL, \`completion_percentage\` decimal(5,2) NOT NULL DEFAULT '0.00', \`project_id\` varchar(255) NOT NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), \`deleted_at\` datetime(6) NULL, \`projectId\` varchar(36) NULL, PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`project_documents\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NULL, \`type\` enum ('contract', 'blueprint', 'permit', 'invoice', 'report', 'specification', 'photo', 'other') NOT NULL DEFAULT 'other', \`file_path\` varchar(255) NOT NULL, \`file_size\` int NOT NULL COMMENT 'Tamaño en bytes', \`file_type\` varchar(255) NOT NULL COMMENT 'MIME type', \`version\` int NOT NULL DEFAULT '1', \`project_id\` varchar(255) NOT NULL, \`uploaded_by\` varchar(255) NOT NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`budget_items\` (\`id\` varchar(36) NOT NULL, \`description\` varchar(255) NOT NULL, \`quantity\` decimal(10,2) NOT NULL, \`unit_of_measure\` varchar(255) NOT NULL, \`unit_price\` decimal(10,2) NOT NULL, \`subtotal\` decimal(12,2) NOT NULL, \`category\` varchar(255) NULL COMMENT 'Categoría del ítem (materiales, mano de obra, etc.)', \`budget_id\` varchar(255) NOT NULL, \`material_id\` varchar(255) NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`project_budgets\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NULL, \`status\` enum ('draft', 'approved', 'revised', 'executed') NOT NULL DEFAULT 'draft', \`version\` int NOT NULL DEFAULT '1', \`subtotal\` decimal(12,2) NOT NULL, \`taxPercentage\` decimal(5,2) NOT NULL DEFAULT '12.00', \`tax\` decimal(12,2) NOT NULL, \`total\` decimal(12,2) NOT NULL, \`project_id\` varchar(255) NOT NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`project_team_members\` (\`id\` varchar(36) NOT NULL, \`role\` enum ('project_manager', 'architect', 'engineer', 'foreman', 'worker', 'specialist', 'other') NOT NULL DEFAULT 'worker', \`responsibilities\` text NULL, \`hourly_rate\` decimal(10,2) NULL, \`allocated_hours\` int NULL, \`start_date\` date NULL, \`end_date\` date NULL, \`project_id\` varchar(255) NOT NULL, \`user_id\` varchar(255) NOT NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`projects\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NULL, \`status\` enum ('planning', 'in_progress', 'on_hold', 'completed', 'cancelled') NOT NULL DEFAULT 'planning', \`type\` enum ('residential', 'commercial', 'industrial', 'infrastructure', 'remodeling', 'maintenance', 'other') NULL, \`client_name\` varchar(255) NULL, \`client_email\` varchar(255) NULL, \`client_phone\` varchar(255) NULL, \`start_date\` date NOT NULL, \`end_date\` date NULL, \`estimated_completion_date\` date NULL, \`completion_percentage\` decimal(5,2) NOT NULL DEFAULT '0.00', \`total_area\` decimal(10,2) NULL COMMENT 'Área total en metros cuadrados', \`construction_area\` decimal(10,2) NULL COMMENT 'Área de construcción en metros cuadrados', \`floors\` int NULL COMMENT 'Número de pisos', \`location\` json NULL COMMENT 'Coordenadas de ubicación', \`is_active\` tinyint NOT NULL DEFAULT 1, \`permits\` json NULL COMMENT 'Permisos y licencias', \`tags\` json NULL COMMENT 'Etiquetas para categorización', \`estimatedBudget\` decimal(12,2) NULL COMMENT 'Presupuesto total estimado', \`currentCost\` decimal(12,2) NULL COMMENT 'Costo total actual', \`user_id\` varchar(255) NOT NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), \`deleted_at\` datetime(6) NULL, PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`calculation_parameters\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NOT NULL, \`dataType\` enum ('string', 'number', 'boolean', 'date', 'enum', 'object', 'array') NOT NULL, \`scope\` enum ('input', 'internal', 'output') NOT NULL DEFAULT 'input', \`display_order\` int NOT NULL DEFAULT '0', \`is_required\` tinyint NOT NULL DEFAULT 1, \`default_value\` text NULL, \`min_value\` float NULL, \`max_value\` float NULL, \`regex_pattern\` varchar(255) NULL, \`unit_of_measure\` varchar(255) NULL, \`allowed_values\` text NULL, \`help_text\` text NULL, \`depends_on_parameters\` text NULL, \`formula\` text NULL, \`calculation_template_id\` varchar(255) NOT NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`calculation_templates\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NOT NULL, \`type\` enum ('area_volume', 'structural', 'material_estimation', 'budget', 'installation', 'design', 'user_defined', 'architecture', 'HVAC', 'fire_safety', 'efficiency', 'foundation', 'electrical', 'telecommunications') NOT NULL, \`targetProfession\` enum ('architect', 'civil_engineer', 'construction_worker', 'plumber', 'electrician', 'contractor', 'all', 'safety_engineer', 'mechanical_engineer', 'electrical_engineer', 'telecommunications_engineer') NOT NULL, \`formula\` text NOT NULL, \`nec_reference\` varchar(255) NULL, \`is_active\` tinyint NOT NULL DEFAULT 1, \`version\` int NOT NULL DEFAULT '1', \`parent_template_id\` varchar(255) NULL, \`source\` enum ('system', 'user', 'community', 'improved') NOT NULL DEFAULT 'system', \`created_by\` varchar(255) NULL, \`is_verified\` tinyint NOT NULL DEFAULT 0, \`verified_by\` varchar(255) NULL, \`verified_at\` datetime NULL, \`is_featured\` tinyint NOT NULL DEFAULT 0, \`usage_count\` int NOT NULL DEFAULT '0', \`average_rating\` decimal(3,2) NOT NULL DEFAULT '0.00', \`rating_count\` int NOT NULL DEFAULT '0', \`tags\` json NULL, \`share_level\` enum ('private', 'organization', 'public') NOT NULL DEFAULT 'private', \`difficulty\` varchar(255) NULL DEFAULT 'intermediate', \`estimated_time\` int NULL DEFAULT '5', \`compliance_level\` varchar(255) NULL DEFAULT 'basic', \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), INDEX \`IDX_calculation_templates_target_profession\` (\`targetProfession\`), INDEX \`IDX_calculation_templates_difficulty\` (\`difficulty\`), INDEX \`IDX_calculation_templates_usage_rating\` (\`usage_count\`, \`average_rating\`), INDEX \`IDX_calculation_templates_type_verified_active\` (\`type\`, \`is_verified\`, \`is_active\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`calculation_results\` (\`id\` varchar(36) NOT NULL, \`calculation_template_id\` varchar(255) NOT NULL, \`project_id\` varchar(255) NULL, \`user_id\` varchar(255) NOT NULL, \`inputParameters\` json NOT NULL, \`results\` json NOT NULL, \`is_saved\` tinyint NOT NULL DEFAULT 0, \`name\` varchar(255) NULL, \`notes\` text NULL, \`execution_time_ms\` int NULL, \`was_successful\` tinyint NOT NULL DEFAULT 1, \`error_message\` text NULL, \`used_in_project\` tinyint NOT NULL DEFAULT 0, \`led_to_material_order\` tinyint NOT NULL DEFAULT 0, \`led_to_budget\` tinyint NOT NULL DEFAULT 0, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), INDEX \`IDX_calculation_results_template\` (\`calculation_template_id\`), INDEX \`IDX_calculation_results_saved\` (\`is_saved\`), INDEX \`IDX_calculation_results_user_created\` (\`user_id\`, \`created_at\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`user_template_usage_logs\` (\`id\` varchar(36) NOT NULL, \`template_id\` varchar(255) NOT NULL, \`template_type\` enum ('personal', 'verified') NOT NULL, \`user_id\` varchar(255) NOT NULL, \`project_id\` varchar(255) NULL, \`calculation_result_id\` varchar(255) NOT NULL, \`usage_date\` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP, \`execution_time_ms\` int NOT NULL, \`was_successful\` tinyint NOT NULL DEFAULT 1, \`ip_address\` varchar(45) NULL, \`user_agent\` text NULL, \`input_parameters\` json NULL, \`output_results\` json NULL, \`error_message\` text NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), INDEX \`IDX_usage_log_project\` (\`project_id\`), INDEX \`IDX_usage_log_period\` (\`template_id\`, \`template_type\`, \`usage_date\`), INDEX \`IDX_usage_log_date\` (\`usage_date\`), INDEX \`IDX_usage_log_user\` (\`user_id\`), INDEX \`IDX_usage_log_template\` (\`template_id\`, \`template_type\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`user_recommendations\` (\`id\` varchar(36) NOT NULL, \`user_id\` varchar(255) NOT NULL, \`type\` enum ('material', 'category', 'project_type', 'supplier') NOT NULL, \`material_id\` varchar(255) NULL, \`category_id\` varchar(255) NULL, \`project_type\` varchar(255) NULL, \`supplier_id\` varchar(255) NULL, \`score\` decimal(5,4) NOT NULL COMMENT 'Puntuación de relevancia (0-1)', \`reason\` text NULL, \`status\` enum ('pending', 'viewed', 'clicked', 'converted', 'dismissed') NOT NULL DEFAULT 'pending', \`expires_at\` datetime NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`material_parameters\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NOT NULL, \`dataType\` enum ('string', 'number', 'boolean', 'enum', 'array') NOT NULL, \`scope\` enum ('input', 'output', 'calculated') NOT NULL, \`display_order\` int NOT NULL, \`is_required\` tinyint NOT NULL, \`default_value\` varchar(255) NULL, \`min_value\` float NULL, \`max_value\` float NULL, \`unit\` enum ('m2', 'm3', 'ml', 'units', 'kg', 'bags', 'sheets') NULL, \`allowedValues\` text NULL, \`help_text\` text NULL, \`depends_on_parameters\` text NULL, \`material_calculation_template_id\` varchar(255) NULL, \`user_material_calculation_template_id\` varchar(255) NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`material_calculation_templates\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NOT NULL, \`type\` enum ('masonry', 'concrete', 'finishes', 'stairs', 'electrical', 'furniture', 'mortar', 'flooring') NOT NULL, \`sub_category\` varchar(255) NOT NULL, \`formula\` longtext NOT NULL, \`materialOutputs\` json NOT NULL, \`wasteFactors\` json NOT NULL, \`regionalFactors\` json NULL, \`normative_reference\` varchar(255) NULL, \`is_active\` tinyint NOT NULL DEFAULT 1, \`is_verified\` tinyint NOT NULL DEFAULT 1, \`is_featured\` tinyint NOT NULL DEFAULT 0, \`share_level\` enum ('public', 'private', 'organization') NOT NULL DEFAULT 'public', \`created_by\` varchar(255) NULL, \`version\` int NOT NULL DEFAULT '1', \`usage_count\` int NOT NULL DEFAULT '0', \`average_rating\` decimal(3,2) NOT NULL DEFAULT '0.00', \`rating_count\` int NOT NULL DEFAULT '0', \`tags\` text NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`user_material_calculation_templates\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NOT NULL, \`type\` enum ('masonry', 'concrete', 'finishes', 'stairs', 'electrical', 'furniture', 'mortar', 'flooring') NOT NULL, \`sub_category\` varchar(255) NOT NULL, \`formula\` longtext NOT NULL, \`materialOutputs\` json NOT NULL, \`wasteFactors\` json NOT NULL, \`user_id\` varchar(255) NOT NULL, \`base_template_id\` varchar(255) NULL, \`is_public\` tinyint NOT NULL DEFAULT 0, \`is_active\` tinyint NOT NULL DEFAULT 1, \`usage_count\` int NOT NULL DEFAULT '0', \`average_rating\` decimal(3,2) NOT NULL DEFAULT '0.00', \`rating_count\` int NOT NULL DEFAULT '0', \`tags\` text NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`user_favorites\` (\`user_id\` varchar(255) NOT NULL, \`template_id\` varchar(255) NOT NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), INDEX \`IDX_user_favorites_template\` (\`template_id\`), INDEX \`IDX_user_favorites_user\` (\`user_id\`), PRIMARY KEY (\`user_id\`, \`template_id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`user_interactions\` (\`id\` varchar(36) NOT NULL, \`user_id\` varchar(255) NOT NULL, \`type\` enum ('view', 'search', 'click', 'favorite', 'add_to_cart', 'purchase', 'rate', 'review', 'share', 'download') NOT NULL, \`material_id\` varchar(255) NULL, \`category_id\` varchar(255) NULL, \`project_id\` varchar(255) NULL, \`search_query\` varchar(255) NULL, \`metadata\` json NULL, \`session_id\` varchar(255) NULL, \`ip_address\` varchar(255) NULL, \`user_agent\` text NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`user_calculation_templates\` (\`id\` varchar(36) NOT NULL, \`user_id\` varchar(255) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NOT NULL, \`long_description\` text NULL, \`source_type\` enum ('created', 'copied', 'from_result') NOT NULL, \`original_template_id\` varchar(255) NULL, \`source_calculation_result_id\` varchar(255) NULL, \`category\` varchar(50) NOT NULL, \`subcategory\` varchar(50) NULL, \`target_professions\` json NOT NULL, \`difficulty\` enum ('basic', 'intermediate', 'advanced') NOT NULL DEFAULT 'basic', \`estimated_time\` varchar(50) NULL, \`nec_reference\` varchar(255) NULL, \`tags\` json NULL, \`formula\` longtext NOT NULL, \`parameters\` json NOT NULL, \`is_public\` tinyint NOT NULL DEFAULT 0, \`is_active\` tinyint NOT NULL DEFAULT 1, \`version\` varchar(10) NOT NULL DEFAULT '1.0', \`status\` enum ('draft', 'active', 'archived') NOT NULL DEFAULT 'draft', \`requirements\` json NULL, \`application_cases\` json NULL, \`limitations\` json NULL, \`shared_with\` json NULL, \`contributors\` json NULL, \`usage_count\` int NOT NULL DEFAULT '0', \`total_ratings\` int NOT NULL DEFAULT '0', \`average_rating\` decimal(3,2) NOT NULL DEFAULT '0.00', \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), INDEX \`IDX_user_templates_created\` (\`user_id\`, \`created_at\`), INDEX \`IDX_user_templates_public\` (\`is_public\`, \`is_active\`), INDEX \`IDX_user_templates_source\` (\`source_type\`, \`original_template_id\`), INDEX \`IDX_user_templates_status\` (\`status\`, \`is_active\`), INDEX \`IDX_user_templates_category\` (\`category\`), INDEX \`IDX_user_templates_user\` (\`user_id\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`template_suggestions\` (\`id\` varchar(36) NOT NULL, \`template_id\` varchar(255) NOT NULL, \`user_id\` varchar(255) NOT NULL, \`suggestion_type\` enum ('improvement', 'correction', 'addition', 'other') NOT NULL DEFAULT 'improvement', \`title\` varchar(255) NOT NULL, \`description\` text NOT NULL, \`current_value\` text NULL, \`proposed_value\` text NULL, \`justification\` text NULL, \`priority\` enum ('low', 'medium', 'high') NOT NULL DEFAULT 'medium', \`affects_accuracy\` tinyint NOT NULL DEFAULT 0, \`affects_compliance\` tinyint NOT NULL DEFAULT 0, \`references\` json NULL, \`contact_for_followup\` tinyint NOT NULL DEFAULT 0, \`status\` enum ('pending', 'approved', 'rejected', 'implemented') NOT NULL DEFAULT 'pending', \`reviewed_by\` varchar(255) NULL, \`reviewed_at\` datetime NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), INDEX \`IDX_template_suggestions_status\` (\`status\`), INDEX \`IDX_template_suggestions_user\` (\`user_id\`), INDEX \`IDX_template_suggestions_template\` (\`template_id\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`user_template_usage\` (\`id\` varchar(36) NOT NULL, \`user_id\` varchar(255) NOT NULL, \`calculation_template_id\` varchar(255) NOT NULL, \`project_id\` varchar(255) NULL, \`usage_count\` int NOT NULL DEFAULT '1', \`last_used_at\` datetime NOT NULL, \`first_used_at\` datetime NOT NULL, \`is_favorite\` tinyint NOT NULL DEFAULT 0, \`average_completion_time_ms\` int NULL, \`average_calculation_time_ms\` int NULL, \`user_rating\` decimal(3,2) NULL, \`has_provided_feedback\` tinyint NOT NULL DEFAULT 0, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`trending_calculations\` (\`id\` varchar(36) NOT NULL, \`template_id\` varchar(255) NOT NULL, \`period\` enum ('daily', 'weekly', 'monthly') NOT NULL DEFAULT 'weekly', \`usage_count\` int NOT NULL DEFAULT '0', \`trend_score\` decimal(10,4) NOT NULL DEFAULT '0.0000', \`rank_position\` int NULL, \`period_start\` datetime NOT NULL, \`period_end\` datetime NOT NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), INDEX \`IDX_trending_calculations_template\` (\`template_id\`), INDEX \`IDX_trending_calculations_period_rank\` (\`period\`, \`rank_position\`), INDEX \`IDX_trending_calculations_period\` (\`period\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`template_ratings\` (\`id\` varchar(36) NOT NULL, \`template_id\` varchar(255) NOT NULL, \`user_id\` varchar(255) NOT NULL, \`rating\` int NOT NULL, \`comment\` text NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), INDEX \`IDX_template_ratings_user\` (\`user_id\`), INDEX \`IDX_template_ratings_template\` (\`template_id\`), UNIQUE INDEX \`UQ_template_ratings_user_template\` (\`template_id\`, \`user_id\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`template_rankings\` (\`id\` varchar(36) NOT NULL, \`template_id\` varchar(255) NOT NULL, \`template_type\` enum ('personal', 'verified') NOT NULL, \`period\` enum ('daily', 'weekly', 'monthly', 'yearly') NOT NULL, \`period_start\` date NOT NULL, \`period_end\` date NOT NULL, \`usage_count\` int NOT NULL DEFAULT '0', \`unique_users\` int NOT NULL DEFAULT '0', \`success_rate\` decimal(5,2) NOT NULL DEFAULT '0.00', \`average_execution_time\` decimal(10,2) NOT NULL DEFAULT '0.00', \`rank_position\` int NOT NULL DEFAULT '0', \`trend_score\` decimal(10,4) NOT NULL DEFAULT '0.0000', \`growth_rate\` decimal(5,2) NOT NULL DEFAULT '0.00', \`average_rating\` decimal(3,2) NOT NULL DEFAULT '0.00', \`total_ratings\` int NOT NULL DEFAULT '0', \`favorite_count\` int NOT NULL DEFAULT '0', \`weighted_score\` decimal(10,4) NOT NULL DEFAULT '0.0000', \`velocity_score\` decimal(10,4) NOT NULL DEFAULT '0.0000', \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), UNIQUE INDEX \`IDX_ranking_unique_period\` (\`template_id\`, \`template_type\`, \`period\`, \`period_start\`), INDEX \`IDX_ranking_period_active\` (\`period\`, \`period_start\`, \`period_end\`), INDEX \`IDX_ranking_trend\` (\`period\`, \`trend_score\`), INDEX \`IDX_ranking_period\` (\`period\`, \`period_start\`, \`rank_position\`), INDEX \`IDX_ranking_template\` (\`template_id\`, \`template_type\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`refresh_tokens\` (\`id\` varchar(36) NOT NULL, \`token\` varchar(255) NOT NULL, \`user_id\` varchar(255) NOT NULL, \`expires_at\` datetime NOT NULL, \`revoked\` tinyint NOT NULL DEFAULT 0, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`promotion_requests\` (\`id\` varchar(36) NOT NULL, \`personal_template_id\` varchar(255) NOT NULL, \`requested_by\` varchar(255) NOT NULL, \`original_author_id\` varchar(255) NOT NULL, \`reason\` text NOT NULL, \`detailed_justification\` text NULL, \`metrics\` json NOT NULL, \`status\` enum ('pending', 'under_review', 'approved', 'rejected', 'implemented') NOT NULL DEFAULT 'pending', \`priority\` enum ('low', 'medium', 'high', 'urgent') NOT NULL DEFAULT 'medium', \`reviewed_by\` varchar(255) NULL, \`reviewed_at\` timestamp NULL, \`review_comments\` text NULL, \`verified_template_id\` varchar(255) NULL, \`credit_to_author\` tinyint NOT NULL DEFAULT 1, \`estimated_impact\` json NULL, \`approval_workflow\` json NULL, \`implementation_notes\` text NULL, \`quality_score\` decimal(3,2) NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), INDEX \`IDX_promotion_template\` (\`personal_template_id\`), INDEX \`IDX_promotion_priority\` (\`priority\`, \`status\`), INDEX \`IDX_promotion_requested\` (\`created_at\`), INDEX \`IDX_promotion_author\` (\`original_author_id\`), INDEX \`IDX_promotion_status\` (\`status\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`orders\` (\`id\` varchar(36) NOT NULL, \`project_id\` varchar(255) NOT NULL, \`user_id\` varchar(255) NOT NULL, \`reference\` varchar(255) NOT NULL, \`status\` enum ('pending', 'processing', 'shipped', 'delivered', 'cancelled') NOT NULL DEFAULT 'pending', \`payment_status\` enum ('pending', 'paid', 'refunded', 'failed') NOT NULL DEFAULT 'pending', \`subtotal\` decimal(10,2) NOT NULL, \`tax_amount\` decimal(10,2) NOT NULL, \`shipping_amount\` decimal(10,2) NOT NULL, \`discount_amount\` decimal(10,2) NOT NULL, \`total\` decimal(10,2) NOT NULL, \`notes\` text NULL, \`shipping_address\` json NOT NULL, \`estimated_delivery_date\` date NULL, \`actual_delivery_date\` date NULL, \`tracking_info\` json NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`order_items\` (\`id\` varchar(36) NOT NULL, \`order_id\` varchar(255) NOT NULL, \`material_id\` varchar(255) NOT NULL, \`quantity\` decimal(10,2) NOT NULL, \`unit_price\` decimal(10,2) NOT NULL, \`subtotal\` decimal(10,2) NOT NULL, \`status\` enum ('pending', 'processing', 'shipped', 'delivered', 'cancelled') NOT NULL, \`material_request_id\` varchar(255) NULL, \`notes\` text NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`material_calculation_results\` (\`id\` varchar(36) NOT NULL, \`template_id\` varchar(255) NOT NULL, \`template_type\` enum ('official', 'user') NOT NULL, \`user_id\` varchar(255) NOT NULL, \`project_id\` varchar(255) NULL, \`input_parameters\` json NOT NULL, \`material_quantities\` json NOT NULL, \`total_cost\` decimal(12,2) NULL, \`currency\` varchar(255) NULL, \`waste_included\` tinyint NOT NULL DEFAULT 1, \`regional_factors_applied\` tinyint NOT NULL DEFAULT 0, \`notes\` text NULL, \`is_saved\` tinyint NOT NULL DEFAULT 0, \`is_shared\` tinyint NOT NULL DEFAULT 0, \`execution_time\` int NOT NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`material_template_usage_logs\` (\`id\` varchar(36) NOT NULL, \`template_id\` varchar(255) NOT NULL, \`template_type\` enum ('official', 'user') NOT NULL, \`material_type\` enum ('masonry', 'concrete', 'finishes', 'stairs', 'electrical', 'furniture', 'mortar', 'flooring') NOT NULL, \`sub_category\` varchar(255) NOT NULL, \`user_id\` varchar(255) NOT NULL, \`project_id\` varchar(255) NULL, \`calculation_result_id\` varchar(255) NOT NULL, \`usage_date\` datetime NOT NULL, \`execution_time_ms\` int NOT NULL, \`was_successful\` tinyint NOT NULL DEFAULT 1, \`total_materials_calculated\` int NOT NULL, \`waste_included\` tinyint NOT NULL DEFAULT 1, \`regional_factors_applied\` tinyint NOT NULL DEFAULT 0, \`total_cost\` decimal(12,2) NULL, \`ip_address\` varchar(45) NULL, \`user_agent\` text NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`notifications\` (\`id\` varchar(36) NOT NULL, \`user_id\` varchar(255) NOT NULL, \`type\` enum ('price_change', 'project_delay', 'material_request', 'task_assignment', 'document_upload', 'payment_due', 'inventory_low', 'calculation_complete', 'system_announcement', 'budget_approval', 'price_update', 'material_import', 'info', 'warning', 'error', 'success', 'system') NOT NULL, \`priority\` enum ('low', 'medium', 'high', 'critical') NOT NULL DEFAULT 'medium', \`title\` varchar(255) NOT NULL, \`content\` text NOT NULL, \`is_read\` tinyint NOT NULL DEFAULT 0, \`read_at\` datetime NULL, \`action_url\` varchar(255) NULL, \`action_text\` varchar(255) NULL, \`related_entity_type\` varchar(255) NULL, \`related_entity_id\` varchar(255) NULL, \`expires_at\` datetime NULL, \`icon\` varchar(255) NULL, \`sms_sent\` tinyint NOT NULL DEFAULT 0, \`email_sent\` tinyint NOT NULL DEFAULT 0, \`push_sent\` tinyint NOT NULL DEFAULT 0, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`material_template_rankings\` (\`id\` varchar(36) NOT NULL, \`template_id\` varchar(255) NOT NULL, \`template_type\` enum ('official', 'user') NOT NULL, \`material_type\` enum ('masonry', 'concrete', 'finishes', 'stairs', 'electrical', 'furniture', 'mortar', 'flooring') NOT NULL, \`sub_category\` varchar(255) NOT NULL, \`period\` enum ('daily', 'weekly', 'monthly', 'yearly') NOT NULL, \`period_start\` date NOT NULL, \`period_end\` date NOT NULL, \`usage_count\` int NOT NULL DEFAULT '0', \`unique_users\` int NOT NULL DEFAULT '0', \`unique_projects\` int NOT NULL DEFAULT '0', \`success_rate\` decimal(5,2) NOT NULL DEFAULT '0.00', \`average_execution_time\` decimal(10,2) NOT NULL DEFAULT '0.00', \`average_materials_count\` decimal(8,2) NOT NULL DEFAULT '0.00', \`total_cost_calculated\` decimal(15,2) NOT NULL DEFAULT '0.00', \`rank_position\` int NOT NULL DEFAULT '0', \`trend_score\` decimal(10,4) NOT NULL DEFAULT '0.0000', \`growth_rate\` decimal(8,4) NOT NULL DEFAULT '0.0000', \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`material_property_definitions\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NULL, \`propertyType\` enum ('text', 'number', 'boolean', 'date', 'select', 'multiselect', 'color', 'dimension') NOT NULL DEFAULT 'text', \`is_required\` tinyint NOT NULL DEFAULT 0, \`is_filterable\` tinyint NOT NULL DEFAULT 0, \`is_visible_in_list\` tinyint NOT NULL DEFAULT 1, \`display_order\` int NOT NULL DEFAULT '0', \`options\` json NULL, \`category_id\` varchar(255) NOT NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`material_property_values\` (\`id\` varchar(36) NOT NULL, \`material_id\` varchar(255) NOT NULL, \`property_definition_id\` varchar(255) NOT NULL, \`text_value\` text NULL, \`number_value\` decimal(18,6) NULL, \`boolean_value\` tinyint NULL, \`date_value\` datetime NULL, \`array_value\` text NULL, \`json_value\` json NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`material_price_history\` (\`id\` varchar(36) NOT NULL, \`material_id\` varchar(255) NOT NULL, \`price\` decimal(10,2) NOT NULL, \`wholesale_price\` decimal(10,2) NULL, \`wholesale_min_quantity\` int NULL, \`effective_date\` date NOT NULL, \`end_date\` date NULL, \`reason\` enum ('supplier_update', 'market_fluctuation', 'promotion', 'seasonal_change', 'inflation_adjustment', 'bulk_discount', 'other') NULL, \`notes\` text NULL, \`supplier_name\` varchar(255) NULL, \`supplier_id\` varchar(255) NULL, \`recorded_by\` varchar(255) NOT NULL, \`price_change_percentage\` decimal(5,2) NULL, \`is_promotion\` tinyint NOT NULL DEFAULT 0, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`invoice_items\` (\`id\` varchar(36) NOT NULL, \`quantity\` int NOT NULL, \`price\` decimal(10,2) NOT NULL, \`subtotal\` decimal(10,2) NOT NULL, \`tax\` decimal(10,2) NOT NULL, \`total\` decimal(10,2) NOT NULL, \`invoice_id\` varchar(255) NOT NULL, \`material_id\` varchar(255) NULL, \`description\` text NOT NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), \`invoiceId\` varchar(36) NULL, \`materialId\` varchar(36) NULL, PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`invoices\` (\`id\` varchar(36) NOT NULL, \`invoice_number\` varchar(255) NOT NULL, \`type\` enum ('sale', 'purchase', 'credit_note', 'debit_note') NOT NULL DEFAULT 'sale', \`issue_date\` date NOT NULL, \`due_date\` date NOT NULL, \`subtotal\` decimal(10,2) NOT NULL, \`taxPercentage\` decimal(5,2) NOT NULL DEFAULT '12.00', \`tax\` decimal(10,2) NOT NULL, \`discount_percentage\` decimal(5,2) NOT NULL DEFAULT '0.00', \`discount\` decimal(10,2) NOT NULL DEFAULT '0.00', \`total\` decimal(10,2) NOT NULL, \`amount_paid\` decimal(10,2) NOT NULL DEFAULT '0.00', \`amount_due\` decimal(10,2) NOT NULL, \`payment_method\` enum ('cash', 'bank_transfer', 'credit_card', 'debit_card', 'check', 'paypal', 'other') NULL, \`payment_reference\` varchar(255) NULL COMMENT 'Número de transacción, cheque, etc.', \`payment_date\` date NULL, \`sri_authorization\` varchar(255) NULL, \`sri_access_key\` varchar(255) NULL COMMENT 'Clave de acceso SRI (para facturación electrónica)', \`electronic_invoice_url\` varchar(255) NULL, \`notes\` text NULL, \`status\` enum ('draft', 'issued', 'sent', 'paid', 'partial', 'overdue', 'cancelled') NOT NULL DEFAULT 'draft', \`client_id\` varchar(255) NOT NULL, \`seller_id\` varchar(255) NOT NULL, \`project_id\` varchar(255) NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), \`deleted_at\` datetime(6) NULL, UNIQUE INDEX \`IDX_d8f8d3788694e1b3f96c42c36f\` (\`invoice_number\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`geographical_zones\` (\`id\` varchar(36) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NULL, \`seismicZone\` enum ('zone_i', 'zone_ii', 'zone_iii', 'zone_iv', 'zone_v') NOT NULL, \`seismic_factor\` decimal(5,3) NOT NULL, \`is_province\` tinyint NOT NULL DEFAULT 1, \`parent_zone_id\` varchar(255) NULL, \`default_soil_type\` enum ('type_a', 'type_b', 'type_c', 'type_d', 'type_e', 'type_f') NULL, \`elevation\` int NULL, \`climate_zone\` varchar(255) NULL, \`wind_speed\` decimal(5,2) NULL, \`rainfall_intensity\` decimal(5,2) NULL, \`snow_load\` decimal(5,2) NULL, \`location_coordinates\` json NULL, \`nec_reference\` varchar(255) NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`calculation_recommendations\` (\`id\` varchar(36) NOT NULL, \`user_id\` varchar(255) NOT NULL, \`project_id\` varchar(255) NULL, \`recommended_template_id\` varchar(255) NOT NULL, \`trigger_template_id\` varchar(255) NULL, \`reason\` enum ('similar_project', 'next_logical_step', 'frequently_used_together', 'improved_version', 'popular_in_profession', 'user_history') NOT NULL, \`score\` decimal(5,4) NOT NULL, \`is_clicked\` tinyint NOT NULL DEFAULT 0, \`is_used\` tinyint NOT NULL DEFAULT 0, \`displayed_at\` datetime NOT NULL, \`clicked_at\` datetime NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`calculation_feedback\` (\`id\` varchar(36) NOT NULL, \`calculation_template_id\` varchar(255) NOT NULL, \`calculation_result_id\` varchar(255) NULL, \`user_id\` varchar(255) NOT NULL, \`type\` enum ('rating', 'improvement_suggestion', 'error_report', 'comment', 'parameter_suggestion') NOT NULL, \`rating\` decimal(3,2) NULL, \`comment\` text NULL, \`suggestionDetails\` json NULL, \`is_applied\` tinyint NOT NULL DEFAULT 0, \`applied_to_template_id\` varchar(255) NULL, \`is_reviewed\` tinyint NOT NULL DEFAULT 0, \`reviewed_by\` varchar(255) NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`calculation_improvements\` (\`id\` varchar(36) NOT NULL, \`original_template_id\` varchar(255) NOT NULL, \`improved_template_id\` varchar(255) NULL, \`title\` varchar(255) NOT NULL, \`description\` text NOT NULL, \`proposedChanges\` text NOT NULL, \`status\` enum ('proposed', 'under_review', 'approved', 'implemented', 'rejected') NOT NULL DEFAULT 'proposed', \`proposed_by\` varchar(255) NOT NULL, \`reviewed_by\` varchar(255) NULL, \`feedback_ids\` text NULL, \`is_data_driven\` tinyint NOT NULL DEFAULT 0, \`dataAnalysis\` json NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`calculation_guides\` (\`id\` varchar(36) NOT NULL, \`calculation_template_id\` varchar(255) NOT NULL, \`title\` varchar(255) NOT NULL, \`content\` text NOT NULL, \`created_by\` varchar(255) NOT NULL, \`view_count\` int NOT NULL DEFAULT '0', \`helpful_count\` int NOT NULL DEFAULT '0', \`images\` text NULL, \`video_url\` varchar(255) NULL, \`is_published\` tinyint NOT NULL DEFAULT 1, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`calculation_comparisons\` (\`id\` varchar(36) NOT NULL, \`user_id\` varchar(255) NOT NULL, \`name\` varchar(255) NOT NULL, \`description\` text NULL, \`calculation_ids\` json NOT NULL, \`comparison_data\` json NULL, \`is_saved\` tinyint NOT NULL DEFAULT 0, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), INDEX \`IDX_calculation_comparisons_saved\` (\`is_saved\`), INDEX \`IDX_calculation_comparisons_user\` (\`user_id\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`author_credits\` (\`id\` varchar(36) NOT NULL, \`verified_template_id\` varchar(255) NOT NULL, \`original_personal_template_id\` varchar(255) NOT NULL, \`original_author_id\` varchar(255) NOT NULL, \`credit_type\` enum ('full_author', 'contributor', 'inspiration', 'collaborator', 'reviewer') NOT NULL DEFAULT 'full_author', \`credit_text\` text NOT NULL, \`custom_attribution\` text NULL, \`is_visible\` tinyint NOT NULL DEFAULT 1, \`visibility\` enum ('public', 'restricted', 'private') NOT NULL DEFAULT 'public', \`contribution_description\` text NULL, \`contribution_percentage\` decimal(5,2) NULL, \`original_creation_date\` timestamp NULL, \`promotion_date\` timestamp NULL, \`promotion_request_id\` varchar(255) NULL, \`metrics_at_promotion\` json NULL, \`points_awarded\` int NOT NULL DEFAULT '0', \`badge_earned\` varchar(255) NULL, \`recognition_level\` enum ('bronze', 'silver', 'gold', 'platinum') NULL, \`display_order\` int NOT NULL DEFAULT '0', \`show_author_contact\` tinyint NOT NULL DEFAULT 0, \`show_original_date\` tinyint NOT NULL DEFAULT 1, \`approved_by\` varchar(255) NULL, \`approved_at\` timestamp NULL, \`approval_notes\` text NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), INDEX \`IDX_credit_original\` (\`original_personal_template_id\`), INDEX \`IDX_credit_type\` (\`credit_type\`), INDEX \`IDX_credit_visible\` (\`is_visible\`, \`visibility\`), INDEX \`IDX_credit_author\` (\`original_author_id\`), INDEX \`IDX_credit_verified\` (\`verified_template_id\`), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`CREATE TABLE \`accounting_transactions\` (\`id\` varchar(36) NOT NULL, \`external_id\` varchar(255) NULL, \`date\` date NOT NULL, \`description\` varchar(255) NOT NULL, \`amount\` decimal(12,2) NOT NULL, \`type\` enum ('INCOME', 'EXPENSE', 'BUDGET') NOT NULL, \`status\` enum ('PENDING', 'PROCESSED', 'ERROR') NOT NULL DEFAULT 'PENDING', \`entity_type\` varchar(255) NOT NULL, \`entity_id\` varchar(255) NOT NULL, \`account_code\` varchar(255) NULL, \`user_id\` varchar(255) NOT NULL, \`accounting_system\` varchar(255) NULL, \`metadata\` json NULL, \`error_message\` text NULL, \`created_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), \`updated_at\` datetime(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), PRIMARY KEY (\`id\`)) ENGINE=InnoDB`);
        await queryRunner.query(`ALTER TABLE \`user_addresses\` ADD CONSTRAINT \`FK_7a5100ce0548ef27a6f1533a5ce\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`users\` ADD CONSTRAINT \`FK_4f0f50d9922a0ed51c214f5556b\` FOREIGN KEY (\`admin_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`categories\` ADD CONSTRAINT \`FK_88cea2dc9c31951d06437879b40\` FOREIGN KEY (\`parent_id\`) REFERENCES \`categories\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`materials\` ADD CONSTRAINT \`FK_a342f3b8a3e1af973e7fe5a9ee8\` FOREIGN KEY (\`category_id\`) REFERENCES \`categories\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`materials\` ADD CONSTRAINT \`FK_5b8a3098f5dcf3e2dd209963ffe\` FOREIGN KEY (\`seller_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_requests\` ADD CONSTRAINT \`FK_0841476ce9e40a2604e4d68b022\` FOREIGN KEY (\`taskId\`) REFERENCES \`tasks\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_requests\` ADD CONSTRAINT \`FK_e31033962dc07b8d84a5b7ecb04\` FOREIGN KEY (\`materialId\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_requests\` ADD CONSTRAINT \`FK_7a37fb09c5fc8cb685d91ef7e77\` FOREIGN KEY (\`requesterId\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`tasks\` ADD CONSTRAINT \`FK_2687b3eaf84c102e4704b294d10\` FOREIGN KEY (\`phaseId\`) REFERENCES \`phases\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`tasks\` ADD CONSTRAINT \`FK_9a16d2c86252529f622fa53f1e3\` FOREIGN KEY (\`assigneeId\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`phases\` ADD CONSTRAINT \`FK_5cc8558954b6360a5b7fb5f45fa\` FOREIGN KEY (\`projectId\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`project_documents\` ADD CONSTRAINT \`FK_ce91a721e078a2d9852b61ad8f2\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`project_documents\` ADD CONSTRAINT \`FK_b110388cd486948d3265b5bd1d4\` FOREIGN KEY (\`uploaded_by\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`budget_items\` ADD CONSTRAINT \`FK_c3baf040ebaa2c35a6f5e0fe4d9\` FOREIGN KEY (\`budget_id\`) REFERENCES \`project_budgets\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`budget_items\` ADD CONSTRAINT \`FK_ec3099cfe554eeff19bf6fbb952\` FOREIGN KEY (\`material_id\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`project_budgets\` ADD CONSTRAINT \`FK_fa8f2a72a3c21da4d55045ca7ca\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`project_team_members\` ADD CONSTRAINT \`FK_c1a8ad2f15c8b55e6f6ab702604\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`project_team_members\` ADD CONSTRAINT \`FK_e89a82228cbfdd39876ce6c156b\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`projects\` ADD CONSTRAINT \`FK_bd55b203eb9f92b0c8390380010\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` ADD CONSTRAINT \`FK_e59b425c829bf7d2ee2ee2aacdf\` FOREIGN KEY (\`calculation_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` ADD CONSTRAINT \`FK_8dafddecd6032a3c7f93152c546\` FOREIGN KEY (\`parent_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` ADD CONSTRAINT \`FK_c00f2503acc369fff5d14531c3d\` FOREIGN KEY (\`created_by\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` ADD CONSTRAINT \`FK_bf764a850e92d2eaba5edfcce06\` FOREIGN KEY (\`calculation_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` ADD CONSTRAINT \`FK_853f129c2e18714b20ae9871d25\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` ADD CONSTRAINT \`FK_b84b1267f6e7af4dcab18280295\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` ADD CONSTRAINT \`FK_d65dc0494c747405594dfd0052e\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` ADD CONSTRAINT \`FK_50ed9ad3bb787a81b392954b64c\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` ADD CONSTRAINT \`FK_58c67936db73765e1931f8ca55f\` FOREIGN KEY (\`calculation_result_id\`) REFERENCES \`calculation_results\`(\`id\`) ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` ADD CONSTRAINT \`FK_b65c00f26f1cceff8a096abdf6f\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` ADD CONSTRAINT \`FK_7d269f828eae70d35bffc315669\` FOREIGN KEY (\`material_id\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` ADD CONSTRAINT \`FK_b1efb9ee932ba7548dbab94754f\` FOREIGN KEY (\`category_id\`) REFERENCES \`categories\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` ADD CONSTRAINT \`FK_77a611a071acaa0cf60c3fcebc1\` FOREIGN KEY (\`supplier_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` ADD CONSTRAINT \`FK_fc77d2e4b067b8d186a1e3a3806\` FOREIGN KEY (\`material_calculation_template_id\`) REFERENCES \`material_calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` ADD CONSTRAINT \`FK_06b9bdc564bab6c33c92c4f7cc0\` FOREIGN KEY (\`user_material_calculation_template_id\`) REFERENCES \`user_material_calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_templates\` ADD CONSTRAINT \`FK_51c1a31afa659d89c3457010368\` FOREIGN KEY (\`created_by\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_material_calculation_templates\` ADD CONSTRAINT \`FK_2072c77b7fc09d54360f9ecf085\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_material_calculation_templates\` ADD CONSTRAINT \`FK_08e6b8ce6b2e94be1e50bff48b6\` FOREIGN KEY (\`base_template_id\`) REFERENCES \`material_calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_favorites\` ADD CONSTRAINT \`FK_5238ce0a21cc77dc16c8efe3d36\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_favorites\` ADD CONSTRAINT \`FK_b30a528c31efe7508656585c1ce\` FOREIGN KEY (\`template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` ADD CONSTRAINT \`FK_8165cbaf68d8c40e80bda6468a7\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` ADD CONSTRAINT \`FK_14047a1c98dc98ce5b95d897110\` FOREIGN KEY (\`material_id\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` ADD CONSTRAINT \`FK_7a2b54d9d51d59f9a5ac3903145\` FOREIGN KEY (\`category_id\`) REFERENCES \`categories\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` ADD CONSTRAINT \`FK_e54cbc691fe8044c9f63eec86bb\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` ADD CONSTRAINT \`FK_9f7994d948f498798c8d4776242\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` ADD CONSTRAINT \`FK_cbb26d53c21e1dfb5de9b395ab6\` FOREIGN KEY (\`original_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` ADD CONSTRAINT \`FK_5a088977c3e95dbd185a356b4d0\` FOREIGN KEY (\`source_calculation_result_id\`) REFERENCES \`calculation_results\`(\`id\`) ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` ADD CONSTRAINT \`FK_ec2c251a7e37cc626cf2b5ffe38\` FOREIGN KEY (\`template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` ADD CONSTRAINT \`FK_b6fafbd480309e2a5678f746743\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` ADD CONSTRAINT \`FK_dbe2c5d0c3b4f2b1668a1c0a6fb\` FOREIGN KEY (\`reviewed_by\`) REFERENCES \`users\`(\`id\`) ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage\` ADD CONSTRAINT \`FK_c16b0946e07585182fe7589221b\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage\` ADD CONSTRAINT \`FK_d9873261c805370d7cfb46b5050\` FOREIGN KEY (\`calculation_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`user_template_usage\` ADD CONSTRAINT \`FK_1040ea5eb6a7bc8f68f5aca6856\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`trending_calculations\` ADD CONSTRAINT \`FK_ca2c34e583ae2a7e757d9ac084f\` FOREIGN KEY (\`template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`template_ratings\` ADD CONSTRAINT \`FK_f5e5f67a4e62826f090d4515f06\` FOREIGN KEY (\`template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`template_ratings\` ADD CONSTRAINT \`FK_bc61037fbc88cdc34bed7cd7280\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`refresh_tokens\` ADD CONSTRAINT \`FK_3ddc983c5f7bcf132fd8732c3f4\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` ADD CONSTRAINT \`FK_c77061c4a74b47f8f2d9b132be4\` FOREIGN KEY (\`personal_template_id\`) REFERENCES \`user_calculation_templates\`(\`id\`) ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` ADD CONSTRAINT \`FK_f58798384e72299353142ecfbe5\` FOREIGN KEY (\`requested_by\`) REFERENCES \`users\`(\`id\`) ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` ADD CONSTRAINT \`FK_01220739870eae4142de1b439aa\` FOREIGN KEY (\`original_author_id\`) REFERENCES \`users\`(\`id\`) ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` ADD CONSTRAINT \`FK_9d9a16ba84129d20dd53ea77882\` FOREIGN KEY (\`reviewed_by\`) REFERENCES \`users\`(\`id\`) ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` ADD CONSTRAINT \`FK_a3785bcbb47694708263e0c33a8\` FOREIGN KEY (\`verified_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE SET NULL ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`orders\` ADD CONSTRAINT \`FK_f860cce2698a1155277bc8ec5dc\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`orders\` ADD CONSTRAINT \`FK_a922b820eeef29ac1c6800e826a\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`order_items\` ADD CONSTRAINT \`FK_145532db85752b29c57d2b7b1f1\` FOREIGN KEY (\`order_id\`) REFERENCES \`orders\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`order_items\` ADD CONSTRAINT \`FK_6cf209654257dd47e6451f575ca\` FOREIGN KEY (\`material_id\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`order_items\` ADD CONSTRAINT \`FK_a21e9d18e98c6f9f489a75027d4\` FOREIGN KEY (\`material_request_id\`) REFERENCES \`material_requests\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_calculation_results\` ADD CONSTRAINT \`FK_9b51227c55a6368d5198ca511c3\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_template_usage_logs\` ADD CONSTRAINT \`FK_33904cefc14990ab2239a1a48d7\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_template_usage_logs\` ADD CONSTRAINT \`FK_b0f61b026e9d6dcb81d489a314e\` FOREIGN KEY (\`calculation_result_id\`) REFERENCES \`material_calculation_results\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`notifications\` ADD CONSTRAINT \`FK_9a8a82462cab47c73d25f49261f\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_property_definitions\` ADD CONSTRAINT \`FK_171d1f683987ebaa93622ffb6eb\` FOREIGN KEY (\`category_id\`) REFERENCES \`categories\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_property_values\` ADD CONSTRAINT \`FK_d7f03d84c75568d4331f8f871a9\` FOREIGN KEY (\`material_id\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_property_values\` ADD CONSTRAINT \`FK_80c088158ba9e6176bd007b4bb7\` FOREIGN KEY (\`property_definition_id\`) REFERENCES \`material_property_definitions\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` ADD CONSTRAINT \`FK_5141d0fe1bfecb978037e367d6c\` FOREIGN KEY (\`material_id\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` ADD CONSTRAINT \`FK_a968dc1f591174a862e947a099a\` FOREIGN KEY (\`supplier_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` ADD CONSTRAINT \`FK_733e10acb5c1bd592a7a0f635bb\` FOREIGN KEY (\`recorded_by\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`invoice_items\` ADD CONSTRAINT \`FK_7fb6895fc8fad9f5200e91abb59\` FOREIGN KEY (\`invoiceId\`) REFERENCES \`invoices\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`invoice_items\` ADD CONSTRAINT \`FK_f57d843bb46a121d4ebc9722bda\` FOREIGN KEY (\`materialId\`) REFERENCES \`materials\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`invoices\` ADD CONSTRAINT \`FK_5534ba11e10f1a9953cbdaabf16\` FOREIGN KEY (\`client_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`invoices\` ADD CONSTRAINT \`FK_44bb811de7d3cef32f28094ea19\` FOREIGN KEY (\`seller_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`invoices\` ADD CONSTRAINT \`FK_9ba18dbe4ea525518c4b32df4b6\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` ADD CONSTRAINT \`FK_2ff71ca0895c390a2e74c1d7e47\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` ADD CONSTRAINT \`FK_85d7e3a9cb392c44061e730bf28\` FOREIGN KEY (\`project_id\`) REFERENCES \`projects\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` ADD CONSTRAINT \`FK_15915155175ad73af1d897a8839\` FOREIGN KEY (\`recommended_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` ADD CONSTRAINT \`FK_282e0117b2315610a378e7afc08\` FOREIGN KEY (\`trigger_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` ADD CONSTRAINT \`FK_eb675391ce00b80ef780f1f10b3\` FOREIGN KEY (\`calculation_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` ADD CONSTRAINT \`FK_6ed14207fe2755c8d2530824eeb\` FOREIGN KEY (\`calculation_result_id\`) REFERENCES \`calculation_results\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` ADD CONSTRAINT \`FK_a39098cde243de3776ade5e88b4\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` ADD CONSTRAINT \`FK_51b6edc66f271d96867617f04a9\` FOREIGN KEY (\`applied_to_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` ADD CONSTRAINT \`FK_7d45c7cf8f9fab12dfeb64198c0\` FOREIGN KEY (\`original_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` ADD CONSTRAINT \`FK_043809e28ff744481f88690fcc4\` FOREIGN KEY (\`improved_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` ADD CONSTRAINT \`FK_8b1278d9d2694a5d628a94c654a\` FOREIGN KEY (\`proposed_by\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` ADD CONSTRAINT \`FK_16b423eef8496fd15c5a550e726\` FOREIGN KEY (\`reviewed_by\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_guides\` ADD CONSTRAINT \`FK_36996a12e13bc73d787d9040440\` FOREIGN KEY (\`calculation_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_guides\` ADD CONSTRAINT \`FK_1ab3ec926f27d9c64449b4591f5\` FOREIGN KEY (\`created_by\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`calculation_comparisons\` ADD CONSTRAINT \`FK_27b64d2a83fcf6036cb0b6a9834\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` ADD CONSTRAINT \`FK_b0482532aaafa617557a457d189\` FOREIGN KEY (\`verified_template_id\`) REFERENCES \`calculation_templates\`(\`id\`) ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` ADD CONSTRAINT \`FK_176a03ed29dcb202c736ad4e0f9\` FOREIGN KEY (\`original_personal_template_id\`) REFERENCES \`user_calculation_templates\`(\`id\`) ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`author_credits\` ADD CONSTRAINT \`FK_2e71e389fd6e38788128a2df0ee\` FOREIGN KEY (\`original_author_id\`) REFERENCES \`users\`(\`id\`) ON DELETE CASCADE ON UPDATE NO ACTION`);
        await queryRunner.query(`ALTER TABLE \`accounting_transactions\` ADD CONSTRAINT \`FK_0b7068ced0585a03ca7f3bb6d44\` FOREIGN KEY (\`user_id\`) REFERENCES \`users\`(\`id\`) ON DELETE NO ACTION ON UPDATE NO ACTION`);
    }

    public async down(queryRunner: QueryRunner): Promise<void> {
        await queryRunner.query(`ALTER TABLE \`accounting_transactions\` DROP FOREIGN KEY \`FK_0b7068ced0585a03ca7f3bb6d44\``);
        await queryRunner.query(`ALTER TABLE \`author_credits\` DROP FOREIGN KEY \`FK_2e71e389fd6e38788128a2df0ee\``);
        await queryRunner.query(`ALTER TABLE \`author_credits\` DROP FOREIGN KEY \`FK_176a03ed29dcb202c736ad4e0f9\``);
        await queryRunner.query(`ALTER TABLE \`author_credits\` DROP FOREIGN KEY \`FK_b0482532aaafa617557a457d189\``);
        await queryRunner.query(`ALTER TABLE \`calculation_comparisons\` DROP FOREIGN KEY \`FK_27b64d2a83fcf6036cb0b6a9834\``);
        await queryRunner.query(`ALTER TABLE \`calculation_guides\` DROP FOREIGN KEY \`FK_1ab3ec926f27d9c64449b4591f5\``);
        await queryRunner.query(`ALTER TABLE \`calculation_guides\` DROP FOREIGN KEY \`FK_36996a12e13bc73d787d9040440\``);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` DROP FOREIGN KEY \`FK_16b423eef8496fd15c5a550e726\``);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` DROP FOREIGN KEY \`FK_8b1278d9d2694a5d628a94c654a\``);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` DROP FOREIGN KEY \`FK_043809e28ff744481f88690fcc4\``);
        await queryRunner.query(`ALTER TABLE \`calculation_improvements\` DROP FOREIGN KEY \`FK_7d45c7cf8f9fab12dfeb64198c0\``);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` DROP FOREIGN KEY \`FK_51b6edc66f271d96867617f04a9\``);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` DROP FOREIGN KEY \`FK_a39098cde243de3776ade5e88b4\``);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` DROP FOREIGN KEY \`FK_6ed14207fe2755c8d2530824eeb\``);
        await queryRunner.query(`ALTER TABLE \`calculation_feedback\` DROP FOREIGN KEY \`FK_eb675391ce00b80ef780f1f10b3\``);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` DROP FOREIGN KEY \`FK_282e0117b2315610a378e7afc08\``);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` DROP FOREIGN KEY \`FK_15915155175ad73af1d897a8839\``);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` DROP FOREIGN KEY \`FK_85d7e3a9cb392c44061e730bf28\``);
        await queryRunner.query(`ALTER TABLE \`calculation_recommendations\` DROP FOREIGN KEY \`FK_2ff71ca0895c390a2e74c1d7e47\``);
        await queryRunner.query(`ALTER TABLE \`invoices\` DROP FOREIGN KEY \`FK_9ba18dbe4ea525518c4b32df4b6\``);
        await queryRunner.query(`ALTER TABLE \`invoices\` DROP FOREIGN KEY \`FK_44bb811de7d3cef32f28094ea19\``);
        await queryRunner.query(`ALTER TABLE \`invoices\` DROP FOREIGN KEY \`FK_5534ba11e10f1a9953cbdaabf16\``);
        await queryRunner.query(`ALTER TABLE \`invoice_items\` DROP FOREIGN KEY \`FK_f57d843bb46a121d4ebc9722bda\``);
        await queryRunner.query(`ALTER TABLE \`invoice_items\` DROP FOREIGN KEY \`FK_7fb6895fc8fad9f5200e91abb59\``);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` DROP FOREIGN KEY \`FK_733e10acb5c1bd592a7a0f635bb\``);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` DROP FOREIGN KEY \`FK_a968dc1f591174a862e947a099a\``);
        await queryRunner.query(`ALTER TABLE \`material_price_history\` DROP FOREIGN KEY \`FK_5141d0fe1bfecb978037e367d6c\``);
        await queryRunner.query(`ALTER TABLE \`material_property_values\` DROP FOREIGN KEY \`FK_80c088158ba9e6176bd007b4bb7\``);
        await queryRunner.query(`ALTER TABLE \`material_property_values\` DROP FOREIGN KEY \`FK_d7f03d84c75568d4331f8f871a9\``);
        await queryRunner.query(`ALTER TABLE \`material_property_definitions\` DROP FOREIGN KEY \`FK_171d1f683987ebaa93622ffb6eb\``);
        await queryRunner.query(`ALTER TABLE \`notifications\` DROP FOREIGN KEY \`FK_9a8a82462cab47c73d25f49261f\``);
        await queryRunner.query(`ALTER TABLE \`material_template_usage_logs\` DROP FOREIGN KEY \`FK_b0f61b026e9d6dcb81d489a314e\``);
        await queryRunner.query(`ALTER TABLE \`material_template_usage_logs\` DROP FOREIGN KEY \`FK_33904cefc14990ab2239a1a48d7\``);
        await queryRunner.query(`ALTER TABLE \`material_calculation_results\` DROP FOREIGN KEY \`FK_9b51227c55a6368d5198ca511c3\``);
        await queryRunner.query(`ALTER TABLE \`order_items\` DROP FOREIGN KEY \`FK_a21e9d18e98c6f9f489a75027d4\``);
        await queryRunner.query(`ALTER TABLE \`order_items\` DROP FOREIGN KEY \`FK_6cf209654257dd47e6451f575ca\``);
        await queryRunner.query(`ALTER TABLE \`order_items\` DROP FOREIGN KEY \`FK_145532db85752b29c57d2b7b1f1\``);
        await queryRunner.query(`ALTER TABLE \`orders\` DROP FOREIGN KEY \`FK_a922b820eeef29ac1c6800e826a\``);
        await queryRunner.query(`ALTER TABLE \`orders\` DROP FOREIGN KEY \`FK_f860cce2698a1155277bc8ec5dc\``);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` DROP FOREIGN KEY \`FK_a3785bcbb47694708263e0c33a8\``);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` DROP FOREIGN KEY \`FK_9d9a16ba84129d20dd53ea77882\``);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` DROP FOREIGN KEY \`FK_01220739870eae4142de1b439aa\``);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` DROP FOREIGN KEY \`FK_f58798384e72299353142ecfbe5\``);
        await queryRunner.query(`ALTER TABLE \`promotion_requests\` DROP FOREIGN KEY \`FK_c77061c4a74b47f8f2d9b132be4\``);
        await queryRunner.query(`ALTER TABLE \`refresh_tokens\` DROP FOREIGN KEY \`FK_3ddc983c5f7bcf132fd8732c3f4\``);
        await queryRunner.query(`ALTER TABLE \`template_ratings\` DROP FOREIGN KEY \`FK_bc61037fbc88cdc34bed7cd7280\``);
        await queryRunner.query(`ALTER TABLE \`template_ratings\` DROP FOREIGN KEY \`FK_f5e5f67a4e62826f090d4515f06\``);
        await queryRunner.query(`ALTER TABLE \`trending_calculations\` DROP FOREIGN KEY \`FK_ca2c34e583ae2a7e757d9ac084f\``);
        await queryRunner.query(`ALTER TABLE \`user_template_usage\` DROP FOREIGN KEY \`FK_1040ea5eb6a7bc8f68f5aca6856\``);
        await queryRunner.query(`ALTER TABLE \`user_template_usage\` DROP FOREIGN KEY \`FK_d9873261c805370d7cfb46b5050\``);
        await queryRunner.query(`ALTER TABLE \`user_template_usage\` DROP FOREIGN KEY \`FK_c16b0946e07585182fe7589221b\``);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` DROP FOREIGN KEY \`FK_dbe2c5d0c3b4f2b1668a1c0a6fb\``);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` DROP FOREIGN KEY \`FK_b6fafbd480309e2a5678f746743\``);
        await queryRunner.query(`ALTER TABLE \`template_suggestions\` DROP FOREIGN KEY \`FK_ec2c251a7e37cc626cf2b5ffe38\``);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` DROP FOREIGN KEY \`FK_5a088977c3e95dbd185a356b4d0\``);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` DROP FOREIGN KEY \`FK_cbb26d53c21e1dfb5de9b395ab6\``);
        await queryRunner.query(`ALTER TABLE \`user_calculation_templates\` DROP FOREIGN KEY \`FK_9f7994d948f498798c8d4776242\``);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` DROP FOREIGN KEY \`FK_e54cbc691fe8044c9f63eec86bb\``);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` DROP FOREIGN KEY \`FK_7a2b54d9d51d59f9a5ac3903145\``);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` DROP FOREIGN KEY \`FK_14047a1c98dc98ce5b95d897110\``);
        await queryRunner.query(`ALTER TABLE \`user_interactions\` DROP FOREIGN KEY \`FK_8165cbaf68d8c40e80bda6468a7\``);
        await queryRunner.query(`ALTER TABLE \`user_favorites\` DROP FOREIGN KEY \`FK_b30a528c31efe7508656585c1ce\``);
        await queryRunner.query(`ALTER TABLE \`user_favorites\` DROP FOREIGN KEY \`FK_5238ce0a21cc77dc16c8efe3d36\``);
        await queryRunner.query(`ALTER TABLE \`user_material_calculation_templates\` DROP FOREIGN KEY \`FK_08e6b8ce6b2e94be1e50bff48b6\``);
        await queryRunner.query(`ALTER TABLE \`user_material_calculation_templates\` DROP FOREIGN KEY \`FK_2072c77b7fc09d54360f9ecf085\``);
        await queryRunner.query(`ALTER TABLE \`material_calculation_templates\` DROP FOREIGN KEY \`FK_51c1a31afa659d89c3457010368\``);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` DROP FOREIGN KEY \`FK_06b9bdc564bab6c33c92c4f7cc0\``);
        await queryRunner.query(`ALTER TABLE \`material_parameters\` DROP FOREIGN KEY \`FK_fc77d2e4b067b8d186a1e3a3806\``);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` DROP FOREIGN KEY \`FK_77a611a071acaa0cf60c3fcebc1\``);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` DROP FOREIGN KEY \`FK_b1efb9ee932ba7548dbab94754f\``);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` DROP FOREIGN KEY \`FK_7d269f828eae70d35bffc315669\``);
        await queryRunner.query(`ALTER TABLE \`user_recommendations\` DROP FOREIGN KEY \`FK_b65c00f26f1cceff8a096abdf6f\``);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` DROP FOREIGN KEY \`FK_58c67936db73765e1931f8ca55f\``);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` DROP FOREIGN KEY \`FK_50ed9ad3bb787a81b392954b64c\``);
        await queryRunner.query(`ALTER TABLE \`user_template_usage_logs\` DROP FOREIGN KEY \`FK_d65dc0494c747405594dfd0052e\``);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` DROP FOREIGN KEY \`FK_b84b1267f6e7af4dcab18280295\``);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` DROP FOREIGN KEY \`FK_853f129c2e18714b20ae9871d25\``);
        await queryRunner.query(`ALTER TABLE \`calculation_results\` DROP FOREIGN KEY \`FK_bf764a850e92d2eaba5edfcce06\``);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` DROP FOREIGN KEY \`FK_c00f2503acc369fff5d14531c3d\``);
        await queryRunner.query(`ALTER TABLE \`calculation_templates\` DROP FOREIGN KEY \`FK_8dafddecd6032a3c7f93152c546\``);
        await queryRunner.query(`ALTER TABLE \`calculation_parameters\` DROP FOREIGN KEY \`FK_e59b425c829bf7d2ee2ee2aacdf\``);
        await queryRunner.query(`ALTER TABLE \`projects\` DROP FOREIGN KEY \`FK_bd55b203eb9f92b0c8390380010\``);
        await queryRunner.query(`ALTER TABLE \`project_team_members\` DROP FOREIGN KEY \`FK_e89a82228cbfdd39876ce6c156b\``);
        await queryRunner.query(`ALTER TABLE \`project_team_members\` DROP FOREIGN KEY \`FK_c1a8ad2f15c8b55e6f6ab702604\``);
        await queryRunner.query(`ALTER TABLE \`project_budgets\` DROP FOREIGN KEY \`FK_fa8f2a72a3c21da4d55045ca7ca\``);
        await queryRunner.query(`ALTER TABLE \`budget_items\` DROP FOREIGN KEY \`FK_ec3099cfe554eeff19bf6fbb952\``);
        await queryRunner.query(`ALTER TABLE \`budget_items\` DROP FOREIGN KEY \`FK_c3baf040ebaa2c35a6f5e0fe4d9\``);
        await queryRunner.query(`ALTER TABLE \`project_documents\` DROP FOREIGN KEY \`FK_b110388cd486948d3265b5bd1d4\``);
        await queryRunner.query(`ALTER TABLE \`project_documents\` DROP FOREIGN KEY \`FK_ce91a721e078a2d9852b61ad8f2\``);
        await queryRunner.query(`ALTER TABLE \`phases\` DROP FOREIGN KEY \`FK_5cc8558954b6360a5b7fb5f45fa\``);
        await queryRunner.query(`ALTER TABLE \`tasks\` DROP FOREIGN KEY \`FK_9a16d2c86252529f622fa53f1e3\``);
        await queryRunner.query(`ALTER TABLE \`tasks\` DROP FOREIGN KEY \`FK_2687b3eaf84c102e4704b294d10\``);
        await queryRunner.query(`ALTER TABLE \`material_requests\` DROP FOREIGN KEY \`FK_7a37fb09c5fc8cb685d91ef7e77\``);
        await queryRunner.query(`ALTER TABLE \`material_requests\` DROP FOREIGN KEY \`FK_e31033962dc07b8d84a5b7ecb04\``);
        await queryRunner.query(`ALTER TABLE \`material_requests\` DROP FOREIGN KEY \`FK_0841476ce9e40a2604e4d68b022\``);
        await queryRunner.query(`ALTER TABLE \`materials\` DROP FOREIGN KEY \`FK_5b8a3098f5dcf3e2dd209963ffe\``);
        await queryRunner.query(`ALTER TABLE \`materials\` DROP FOREIGN KEY \`FK_a342f3b8a3e1af973e7fe5a9ee8\``);
        await queryRunner.query(`ALTER TABLE \`categories\` DROP FOREIGN KEY \`FK_88cea2dc9c31951d06437879b40\``);
        await queryRunner.query(`ALTER TABLE \`users\` DROP FOREIGN KEY \`FK_4f0f50d9922a0ed51c214f5556b\``);
        await queryRunner.query(`ALTER TABLE \`user_addresses\` DROP FOREIGN KEY \`FK_7a5100ce0548ef27a6f1533a5ce\``);
        await queryRunner.query(`DROP TABLE \`accounting_transactions\``);
        await queryRunner.query(`DROP INDEX \`IDX_credit_verified\` ON \`author_credits\``);
        await queryRunner.query(`DROP INDEX \`IDX_credit_author\` ON \`author_credits\``);
        await queryRunner.query(`DROP INDEX \`IDX_credit_visible\` ON \`author_credits\``);
        await queryRunner.query(`DROP INDEX \`IDX_credit_type\` ON \`author_credits\``);
        await queryRunner.query(`DROP INDEX \`IDX_credit_original\` ON \`author_credits\``);
        await queryRunner.query(`DROP TABLE \`author_credits\``);
        await queryRunner.query(`DROP INDEX \`IDX_calculation_comparisons_user\` ON \`calculation_comparisons\``);
        await queryRunner.query(`DROP INDEX \`IDX_calculation_comparisons_saved\` ON \`calculation_comparisons\``);
        await queryRunner.query(`DROP TABLE \`calculation_comparisons\``);
        await queryRunner.query(`DROP TABLE \`calculation_guides\``);
        await queryRunner.query(`DROP TABLE \`calculation_improvements\``);
        await queryRunner.query(`DROP TABLE \`calculation_feedback\``);
        await queryRunner.query(`DROP TABLE \`calculation_recommendations\``);
        await queryRunner.query(`DROP TABLE \`geographical_zones\``);
        await queryRunner.query(`DROP INDEX \`IDX_d8f8d3788694e1b3f96c42c36f\` ON \`invoices\``);
        await queryRunner.query(`DROP TABLE \`invoices\``);
        await queryRunner.query(`DROP TABLE \`invoice_items\``);
        await queryRunner.query(`DROP TABLE \`material_price_history\``);
        await queryRunner.query(`DROP TABLE \`material_property_values\``);
        await queryRunner.query(`DROP TABLE \`material_property_definitions\``);
        await queryRunner.query(`DROP TABLE \`material_template_rankings\``);
        await queryRunner.query(`DROP TABLE \`notifications\``);
        await queryRunner.query(`DROP TABLE \`material_template_usage_logs\``);
        await queryRunner.query(`DROP TABLE \`material_calculation_results\``);
        await queryRunner.query(`DROP TABLE \`order_items\``);
        await queryRunner.query(`DROP TABLE \`orders\``);
        await queryRunner.query(`DROP INDEX \`IDX_promotion_status\` ON \`promotion_requests\``);
        await queryRunner.query(`DROP INDEX \`IDX_promotion_author\` ON \`promotion_requests\``);
        await queryRunner.query(`DROP INDEX \`IDX_promotion_requested\` ON \`promotion_requests\``);
        await queryRunner.query(`DROP INDEX \`IDX_promotion_priority\` ON \`promotion_requests\``);
        await queryRunner.query(`DROP INDEX \`IDX_promotion_template\` ON \`promotion_requests\``);
        await queryRunner.query(`DROP TABLE \`promotion_requests\``);
        await queryRunner.query(`DROP TABLE \`refresh_tokens\``);
        await queryRunner.query(`DROP INDEX \`IDX_ranking_template\` ON \`template_rankings\``);
        await queryRunner.query(`DROP INDEX \`IDX_ranking_period\` ON \`template_rankings\``);
        await queryRunner.query(`DROP INDEX \`IDX_ranking_trend\` ON \`template_rankings\``);
        await queryRunner.query(`DROP INDEX \`IDX_ranking_period_active\` ON \`template_rankings\``);
        await queryRunner.query(`DROP INDEX \`IDX_ranking_unique_period\` ON \`template_rankings\``);
        await queryRunner.query(`DROP TABLE \`template_rankings\``);
        await queryRunner.query(`DROP INDEX \`UQ_template_ratings_user_template\` ON \`template_ratings\``);
        await queryRunner.query(`DROP INDEX \`IDX_template_ratings_template\` ON \`template_ratings\``);
        await queryRunner.query(`DROP INDEX \`IDX_template_ratings_user\` ON \`template_ratings\``);
        await queryRunner.query(`DROP TABLE \`template_ratings\``);
        await queryRunner.query(`DROP INDEX \`IDX_trending_calculations_period\` ON \`trending_calculations\``);
        await queryRunner.query(`DROP INDEX \`IDX_trending_calculations_period_rank\` ON \`trending_calculations\``);
        await queryRunner.query(`DROP INDEX \`IDX_trending_calculations_template\` ON \`trending_calculations\``);
        await queryRunner.query(`DROP TABLE \`trending_calculations\``);
        await queryRunner.query(`DROP TABLE \`user_template_usage\``);
        await queryRunner.query(`DROP INDEX \`IDX_template_suggestions_template\` ON \`template_suggestions\``);
        await queryRunner.query(`DROP INDEX \`IDX_template_suggestions_user\` ON \`template_suggestions\``);
        await queryRunner.query(`DROP INDEX \`IDX_template_suggestions_status\` ON \`template_suggestions\``);
        await queryRunner.query(`DROP TABLE \`template_suggestions\``);
        await queryRunner.query(`DROP INDEX \`IDX_user_templates_user\` ON \`user_calculation_templates\``);
        await queryRunner.query(`DROP INDEX \`IDX_user_templates_category\` ON \`user_calculation_templates\``);
        await queryRunner.query(`DROP INDEX \`IDX_user_templates_status\` ON \`user_calculation_templates\``);
        await queryRunner.query(`DROP INDEX \`IDX_user_templates_source\` ON \`user_calculation_templates\``);
        await queryRunner.query(`DROP INDEX \`IDX_user_templates_public\` ON \`user_calculation_templates\``);
        await queryRunner.query(`DROP INDEX \`IDX_user_templates_created\` ON \`user_calculation_templates\``);
        await queryRunner.query(`DROP TABLE \`user_calculation_templates\``);
        await queryRunner.query(`DROP TABLE \`user_interactions\``);
        await queryRunner.query(`DROP INDEX \`IDX_user_favorites_user\` ON \`user_favorites\``);
        await queryRunner.query(`DROP INDEX \`IDX_user_favorites_template\` ON \`user_favorites\``);
        await queryRunner.query(`DROP TABLE \`user_favorites\``);
        await queryRunner.query(`DROP TABLE \`user_material_calculation_templates\``);
        await queryRunner.query(`DROP TABLE \`material_calculation_templates\``);
        await queryRunner.query(`DROP TABLE \`material_parameters\``);
        await queryRunner.query(`DROP TABLE \`user_recommendations\``);
        await queryRunner.query(`DROP INDEX \`IDX_usage_log_template\` ON \`user_template_usage_logs\``);
        await queryRunner.query(`DROP INDEX \`IDX_usage_log_user\` ON \`user_template_usage_logs\``);
        await queryRunner.query(`DROP INDEX \`IDX_usage_log_date\` ON \`user_template_usage_logs\``);
        await queryRunner.query(`DROP INDEX \`IDX_usage_log_period\` ON \`user_template_usage_logs\``);
        await queryRunner.query(`DROP INDEX \`IDX_usage_log_project\` ON \`user_template_usage_logs\``);
        await queryRunner.query(`DROP TABLE \`user_template_usage_logs\``);
        await queryRunner.query(`DROP INDEX \`IDX_calculation_results_user_created\` ON \`calculation_results\``);
        await queryRunner.query(`DROP INDEX \`IDX_calculation_results_saved\` ON \`calculation_results\``);
        await queryRunner.query(`DROP INDEX \`IDX_calculation_results_template\` ON \`calculation_results\``);
        await queryRunner.query(`DROP TABLE \`calculation_results\``);
        await queryRunner.query(`DROP INDEX \`IDX_calculation_templates_type_verified_active\` ON \`calculation_templates\``);
        await queryRunner.query(`DROP INDEX \`IDX_calculation_templates_usage_rating\` ON \`calculation_templates\``);
        await queryRunner.query(`DROP INDEX \`IDX_calculation_templates_difficulty\` ON \`calculation_templates\``);
        await queryRunner.query(`DROP INDEX \`IDX_calculation_templates_target_profession\` ON \`calculation_templates\``);
        await queryRunner.query(`DROP TABLE \`calculation_templates\``);
        await queryRunner.query(`DROP TABLE \`calculation_parameters\``);
        await queryRunner.query(`DROP TABLE \`projects\``);
        await queryRunner.query(`DROP TABLE \`project_team_members\``);
        await queryRunner.query(`DROP TABLE \`project_budgets\``);
        await queryRunner.query(`DROP TABLE \`budget_items\``);
        await queryRunner.query(`DROP TABLE \`project_documents\``);
        await queryRunner.query(`DROP TABLE \`phases\``);
        await queryRunner.query(`DROP TABLE \`tasks\``);
        await queryRunner.query(`DROP TABLE \`material_requests\``);
        await queryRunner.query(`DROP INDEX \`IDX_2c638e9b0ddf9b957accdaa911\` ON \`materials\``);
        await queryRunner.query(`DROP TABLE \`materials\``);
        await queryRunner.query(`DROP TABLE \`categories\``);
        await queryRunner.query(`DROP INDEX \`IDX_97672ac88f789774dd47f7c8be\` ON \`users\``);
        await queryRunner.query(`DROP INDEX \`IDX_users_subscription_plan\` ON \`users\``);
        await queryRunner.query(`DROP TABLE \`users\``);
        await queryRunner.query(`DROP TABLE \`user_addresses\``);
    }

}
